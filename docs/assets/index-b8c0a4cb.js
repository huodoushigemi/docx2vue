import{U as T,A as x,D as u,aX as j,ay as v,bm as C,aI as ne,aK as K,r as E,e as oe,Q as Z,x as Q,a4 as re,bs as se,bt as ae,am as ie,o as le,c as ce,u as w,y as U,bk as W,z as P,O as N,aj as ue,N as S,i as de,F as H,aH as pe,ak as fe,bp as me,aO as $}from"./@vue-e6c15c36.js";import{R as Y}from"./vue-reveal-effect-94b5d062.js";import{_ as R}from"./monaco-editor-7fb5109a.js";import{f as he,r as ge}from"./@vueuse-d8de8cc9.js";import{v as _e}from"./vue-15e3ffcd.js";import{d as ve}from"./docx-preview-32015948.js";import"./@ctrl-43a4208a.js";import"./jszip-1c3a6353.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const be=""+new URL("1-02f4af48.docx",import.meta.url).href,ye=""+new URL("2-d92cb5f6.docx",import.meta.url).href,we=""+new URL("3-cc554d79.docx",import.meta.url).href,F=""+new URL("word-a6e5b8a9.svg",import.meta.url).href,xe=""+new URL("github-540f5a2f.svg",import.meta.url).href,ke=""+new URL("vue-5532db34.svg",import.meta.url).href,Ee=""+new URL("round_down-b71e62d1.svg",import.meta.url).href,Re={grid:"~ auto-cols-[max-content]","gap-x-4":"",relative:"",my4:"",px5:"",py3:"",shadow:"","bg-white":"",class:""},Le=u("img",{"self-center":"",w12:"",h12:"","row-span-2":"",src:F},null,-1),Ae={"text-lg":"",mb1:"",class:"col-[2]"},Pe={"text-sm":"","c-gray":""},q=T({__name:"File",props:{name:null,desc:null,url:null},emits:["preview"],setup(e,{emit:t}){const n=e;async function o(){const a=await(await window.fetch(n.url)).blob();return new File([a],n.name,{type:a.type})}async function r(){t("preview",await o())}async function s(){const a=document.createElement("a");a.href=URL.createObjectURL(await o()),a.download=n.name,a.click(),URL.revokeObjectURL(a.href)}return(a,f)=>(v(),x("div",Re,[Le,u("span",Ae,j(e.name),1),u("span",Pe,j(e.desc),1),u("button",{absolute:"","bottom-2":"","right-16":"","op-30":"","hover:op-60":"",onClick:r},"预览"),u("button",{absolute:"","bottom-2":"","right-4":"","op-30":"","hover:op-60":"",onClick:s},"下载")]))}}),Se={class:"px4 py1 bg-#0078d7 hover:bg-#005ea9 text-white b-0 leading-6","focus:outline":"~ 2 black offset-1"},M=T({__name:"Button",setup(e){return(t,n)=>{const o=K("reveal-effect");return C((v(),x("button",Se,[ne(t.$slots,"default")])),[[o]])}}}),Ce=T({__name:"SFC",props:{sfc:null,props:null},setup(e){const t=e;let n;const o=E();return oe(()=>{if(!t.sfc)return n==null||n.unmount(),n=null;const r=Z(async()=>(await R(()=>import("./vue3-sfc-loader-6999a21f.js").then(s=>s.v),["./vue3-sfc-loader-6999a21f.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).loadModule("App.vue",{moduleCache:{vue:_e},getFile:()=>t.sfc,addStyle(s){o.value.append(Object.assign(document.createElement("style"),{textContent:s}))}}));n==null||n.unmount(),n=Q(()=>re(r,t.props)),n.mount(o.value)}),(r,s)=>(v(),x("div",{ref_key:"el",ref:o},null,512))}});let D;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),D=e,console.log("👍","beforeinstallprompt",e),z.value=!1});const z=E(!0);window.addEventListener("appinstalled",()=>z.value=!0);function Oe(){return{prompt:async()=>await(D==null?void 0:D.prompt()),installed:z}}async function J(e){const t=(await R(()=>import("./gogocode-235ac559.js").then(n=>n.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default;return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(n,o)=>`{{ ${t(o).find("$_$").each(s=>{const a=s.parent(0),f=Ne(s).name;f&&se(f)||(a.node.type=="MemberExpression"&&s.parent(1).node.type!="MemberExpression"?(a.replaceBy(`get('${a.generate()}')`),a.replaceBy(a.node.expression)):a.node.type!="MemberExpression"&&(s.node.name=`get('${s.node.name}')`))}).root().generate({isPretty:!1})} }}`)}function Ne(e){const t=e.parent(0);return t.node.type==="MemberExpression"?t.find("$_$")[0].nodePath.node:e.node}async function $e(e){const t=(await R(()=>import("./gogocode-235ac559.js").then(o=>o.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default,n=t(e).attr("program");if(n.body.length==1&&n.body[0].type==="ExpressionStatement")return["Identifier","MemberExpression"].includes(n.body[0].expression.type)}function X(){let e,t;const n=new Promise((o,r)=>(e=o,t=r));return n.resolve=e,n.reject=t,n}async function De(e){const t=Array.from(e||[]).map(n=>n.webkitGetAsEntry()).filter(n=>n!=null).flat();return await ee(t)}async function ee(e,t=[]){for(const n of e)if(n.isDirectory){const o=n.createReader(),r=X();o.readEntries(s=>ee(s,t).then(r.resolve)),await r}else{const o=X();n.file(r=>{const s=n.fullPath.substring(1),a=Object.defineProperty(r,"webkitRelativePath",{value:s});t.push(a),o.resolve(1)}),await o}return t}function je(e,t=""){const n=Te(e);for(;e=n.pop();)(o=>(t=typeof e=="number"?[]:{})[e]=o)(t);return t}function Te(e){return e.replace(/\\[(.+?)\\]/,".$1").split(".")}async function Ie(e){const t=document.createElement("div");await ve.renderAsync(e,t,void 0,{inWrapper:!1,useBase64URL:!0});for(const n of t.querySelectorAll("*"))for(let o=n.firstChild;o=o==null?void 0:o.nextSibling;)Me(o,o.previousSibling)&&(o.textContent=o.previousSibling.textContent+o.textContent,o.previousSibling.remove());return await Promise.all([...t.querySelectorAll("img")].map(n=>new Promise(o=>(n.onload=o,n.onerror=o)))),t.innerHTML}const te=e=>e.nodeType==3,Ue=e=>(e==null?void 0:e.tagName)==="SPAN"&&e.childNodes.length==1&&te(e.firstChild),We=(e,t)=>(e==null?void 0:e.attributes.length)==(t==null?void 0:t.attributes.length)&&(e==null?void 0:e.getAttributeNames().every(n=>(e==null?void 0:e.getAttribute(n))==(t==null?void 0:t.getAttribute(n)))),Me=(e,t)=>[e,t].every(Ue)&&We(e,t);async function Be(e){const t=g=>{var p;return(p=g.match(/\{\{\s*(.*?)\s*\}\}/))==null?void 0:p[1]},n=g=>g.trim().startsWith("{{")&&g.trim().endsWith("}}"),o=new Set,r=Ve(e.body,"div");for(const g of r.querySelectorAll("*"))for(const p of g.childNodes){if(!te(p))continue;const L=p.textContent.replace(`
`,""),y=p.parentElement,i=p.nextSibling,l=t(L);if(!l)continue;p.textContent=await J(L);const d=await $e(l)?l:null;if(d)if(o.add(d),n(L))if(y.childNodes.length==1)B(y,d);else{const c=e.createElement("span");B(c,d),c.append(p),y.insertBefore(p,i)}else{p.parentNode.removeChild(p);const c=L.match(/(.*?)({{.*?}})(.*)/),[,A,I,O]=c;A&&y.insertBefore(V(G("span",null,A)),i),y.insertBefore(B(e.createElement("span"),d,await J(I)),i),t(O)?y.insertBefore(e.createTextNode(O),i):O&&y.insertBefore(V(G("span",null,O)),i)}}const s=`<template>${r.outerHTML}</template>`,a=`
<script>
export default {
  props: {
    // 哪些字段可以双向绑定，默认全部
    vmodels: Array,
    // known data ${JSON.stringify([...o].reduce((g,p)=>Object.assign(g,je(p)),{}))}
    data: { type: Object, default: () => ({}) }
  },
  computed: {
    edit() {
      const set = new Set(this.vmodels)
      return (prop) => !this.vmodels || set.has(prop)
    }
  },
  methods: {
    onInput({ target }) {
      const prop = target.getAttribute('name')
      this.set(prop, target.textContent)
    },
    getPaths(k) {
      return k.replace(/\\[(.+?)\\]/, '.$1').split('.')
    },
    get(k) {
      return this.getPaths(k).reduce((o, k) => o?.[k], this.data)
    },
    set(k, v) {
      const ks = this.getPaths(k)
      const prop = ks.shift()
      while (k = ks.pop()) (vv => (v = typeof k === 'number' ? [] : {})[k] = vv)(v)
      this._set(prop, v)
    },
    _set(prop, val) {
      if (this.$set) this.$set(this.data, prop, val)
      else this.data[prop] = val
    }
  }
}
<\/script>
`,f=e.querySelectorAll("style"),m=Array.from(f).map(g=>g.textContent).join(`
`),_=Object.assign(e.createElement("style"),{textContent:m});_.setAttribute("scoped",""),_.textContent+=`
  [contenteditable] { background: #7a7a7a12; text-align: center; white-space: break-spaces !important; }
  [contenteditable=false] { cursor: not-allowed; }
  [contenteditable]:empty { padding-left: 1em; padding-right: 1em; }
  [contenteditable]:empty::after { content: '' }
  [contenteditable]:hover { background: #7a7a7a33; }
  `;const b=_==null?void 0:_.outerHTML.replace(/<!--/g,"").replace(/-- ?>/g,""),k=(await R(()=>import("./prettierFormat-3a3234c1.js"),["./prettierFormat-3a3234c1.js","./prettier-e74c6c92.js"],import.meta.url)).default;return k([s,a,b].map(g=>g.trim()).join(`

`).trim())}function Ve(e,t){var o,r;const n=document.createElement(t);return e.getAttributeNames().forEach(s=>n.setAttribute(s,e.getAttribute(s))),n.innerHTML=e.innerHTML,(o=e.parentNode)==null||o.insertBefore(n,e),(r=e.parentNode)==null||r.removeChild(e),n}function B(e,t,n){return t&&(Fe(e,t),V(e)),n&&(e.textContent=n),e}function V(e){const t={fontFamily:"inherit",minHeight:"inherit",fontSize:"inherit"};return e.setAttribute("style",ae(ie([t,e.getAttribute("style")]))),e}function Fe(e,t){return e.id=t,e.setAttribute(":contenteditable",`edit('${t}')`),e.setAttribute("name",t),e.setAttribute("v-on:input","onInput"),e}function G(e,t,n){const o=document.createElement(e);return Object.keys(t??{}).forEach(r=>o.setAttribute(r,t[r])),o.textContent=n,o}const ze={sticky:"!",aic:"",spacex4:"",px4:"","top-0":"","w-full":"",h14:"","box-border":"","bg-white":"","shadow-lg":"","z-9":""},He=u("h1",null,"🔨 Docx To Vue",-1),qe=u("img",{w11:"",h11:"",src:F},null,-1),Je=u("div",{"flex-1":""},null,-1),Xe=u("a",{href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},[u("img",{src:"https://img.shields.io/github/stars/huodoushigemi/docx2vue.svg?style=for-the-badge"})],-1),Ge=u("a",{href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},[u("img",{w10:"",src:xe})],-1),Ke={wrap:"","justify-evenly":""},Ze={key:0,class:"animate__flipInX",absolute:"","inset-0":"",col:"",fcc:"",op60:""},Qe=u("img",{w20:"",mb4:"",src:F},null,-1),Ye={key:1,absolute:"","inset-0":"",fcc:"","text-100":"","c-white":"",class:"bg-#0000002f",style:{"backdrop-filter":"blur(24px)"}},et={w80:""},tt=["onClick"],nt=u("img",{w8:"",py2:"",mr4:"",src:ke},null,-1),ot=["onClick"],rt=u("img",{h14:"","scale-75":"",op40:"",hover:"scale-85 op80",src:Ee,alt:"download",title:"download"},null,-1),st=[rt],at=u("h2",null,"示例",-1),it=u("p",null,[u("a",{"c-inherit":"",href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},"Please give a ⭐️ if this project helped you!")],-1),lt=T({__name:"App",setup(e){const t=Z(async()=>{const i=(await R(()=>import("./monaco-editor-7fb5109a.js").then(d=>d.j),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default,l=(await R(()=>import("./monaco-editor-7fb5109a.js").then(d=>d.a),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default;return window.MonacoEnvironment={getWorker(d,c){return c==="json"?new i:new l}},R(()=>import("./monaco-editor-vue3-6392893e.js"),["./monaco-editor-vue3-6392893e.js","./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)}),n=["1","2","3"].map(i=>new URL(Object.assign({"./assets/1.docx":be,"./assets/2.docx":ye,"./assets/3.docx":we})[`./assets/${i}.docx`],self.location).href),o=new Date(1677209248006).toLocaleString(),{prompt:r,installed:s}=Oe(),a=E(),{isOverDropZone:f}=he(a,()=>{}),m=E([]),_=E(),b=ge(E(),{sfc:"",props:{}});le(()=>{a.value.addEventListener("drop",async i=>{var c;const d=(await De((c=i.dataTransfer)==null?void 0:c.items)).filter(A=>A.name.endsWith(".docx"));if(!d.length)return alert("仅支持 docx 类型的文件");m.value=d,h(m.value[0])})});const k=ce({get:()=>JSON.stringify(b.value.props,null,2),set:i=>b.value.props=JSON.parse(i)});async function h(i){const l=await p(i);g(l),_.value=i}function g(i){var c;const l=(c=i.match(/\/\/ known data (.*)/))==null?void 0:c[1],d={vmodels:null,data:{}};l&&(d.data=JSON.parse(l)),b.value={sfc:i,props:d}}async function p(i){const l=await Ie(i).catch(c=>(alert("文件内容读取失败"),Promise.reject(c))),d=new DOMParser().parseFromString(l,"text/html");return await Be(d)}async function L(i){const l=await p(i),d=i.name.replace(".docx",".vue");let c=document.createElement("a");c.download=d,c.href=URL.createObjectURL(new Blob([l])),c.click()}async function y(){for(const i of m.value)await L(i)}return(i,l)=>{const d=K("reveal-effect");return v(),x(H,null,[C((v(),x("header",ze,[He,qe,Je,Xe,Ge,w(s)?P("",!0):(v(),U(M,{key:0,onClick:w(r)},{default:W(()=>[S("下载")]),_:1},8,["onClick"]))])),[[d]]),u("main",Ke,[u("article",{ref_key:"dropRef",ref:a,relative:"",my4:"","min-h-842pt":"","bg-white":"","z-1":"",style:{"box-shadow":"0px 5px 30px -10px #0000004f"}},[N(Ce,ue(w(b),{"min-w595pt":""}),null,16),_.value?P("",!0):(v(),x("div",Ze,[Qe,S("将 docx 文件或文件夹拖拽至此")])),w(f)?(v(),x("div",Ye,"+")):P("",!0)],512),u("div",et,[N(w(t),{value:w(k),"onUpdate:value":l[0]||(l[0]=c=>de(k)?k.value=c:null),"bg-gray":"",language:"json",height:300,options:{minimap:{enabled:!1},lineNumbers:"off"},shadow:"",class:"animate__animated animate__flipInX",my4:""},null,8,["value"]),m.value.length?(v(),U(M,{key:0,mt4:"",mb2:"",onClick:y},{default:W(()=>[S("下载全部")]),_:1})):P("",!0),m.value.length?(v(),U(M,{key:1,ml2:"",mt4:"",mb2:"",onClick:l[1]||(l[1]=c=>{m.value=[],b.value=null,_.value=null})},{default:W(()=>[S("X")]),_:1})):P("",!0),(v(!0),x(H,null,pe(m.value,(c,A)=>C((v(),x("div",{key:A,aic:"",pl4:"",mb1:"",h14:"","leading-8":"","cursor-pointer":"",class:fe(["bg-#80808033 hover:bg-#8080804f",c==_.value&&"bg-#00162733!"]),onClick:I=>h(c)},[nt,S(" "+j(c.webkitRelativePath.replace(".docx",".vue"))+" ",1),u("div",{mla:"","box-border":"","leading-0":"",class:"bg-#8080801a hover:bg-#80808066",onClick:me(I=>L(c),["stop"])},st,8,ot)],10,tt)),[[d]])),128))]),l[2]||($(-1),l[2]=u("article",{"min-w75":"",px4:""},[at,C(N(q,{name:"exmaple.docx",desc:"示例文件",url:w(n)[0],onPreview:h},null,8,["url"]),[[d]]),C(N(q,{name:"exmaple-img.docx",desc:"带图片的示例",url:w(n)[1],onPreview:h},null,8,["url"]),[[d]])]),$(1),l[2])]),l[3]||($(-1),l[3]=u("footer",{col:"",fcc:"",mt8:"",h40:"","bg-gray-300":""},[u("p",null,[u("b",null,"Last updated: "+j(w(o)),1)]),it]),$(1),l[3])],64)}}});function ct(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:r,onRegisteredSW:s,onRegisterError:a}=e;let f,m;const _=async(k=!0)=>{await m};async function b(){if("serviceWorker"in navigator){const{Workbox:k}=await R(()=>import("./workbox-window-295a6886.js"),[],import.meta.url);f=new k("./sw.js",{scope:"./",type:"classic"}),f.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),f.addEventListener("installed",h=>{h.isUpdate||o==null||o()}),f.register({immediate:t}).then(h=>{s?s("./sw.js",h):r==null||r(h)}).catch(h=>{a==null||a(h)})}}return m=b(),_}function ut(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:o,onRegistered:r,onRegisteredSW:s,onRegisterError:a}=e,f=E(!1),m=E(!1);return{updateServiceWorker:ct({immediate:t,onNeedRefresh(){f.value=!0,n==null||n()},onOfflineReady(){m.value=!0,o==null||o()},onRegistered:r,onRegisteredSW:s,onRegisterError:a}),offlineReady:m,needRefresh:f}}window.addEventListener("appinstalled",()=>console.log("appinstalled"));ut({onNeedRefresh:()=>confirm("新的内容可用，单击确定按钮进行更新")&&location.reload()});Y.setDefaultProps({borderWidth:2,borderColor:"#0000002f"});Q(lt).use(Y).mount("#app");
