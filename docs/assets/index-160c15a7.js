import{U as D,ay as _,A as b,D as c,aX as T,bm as N,aI as ee,aK as z,r as k,e as te,Q as J,x as G,a4 as oe,bs as ne,bt as se,o as re,c as ae,u as y,y as R,bk as I,z as C,O as S,aj as ie,N as L,i as le,F as W,aH as ce,ak as ue,bp as de,aO as O,aC as pe,az as fe}from"./@vue-2f9bc0b9.js";import{R as K}from"./vue-reveal-effect-318013a5.js";import{_ as A}from"./monaco-editor-7fb5109a.js";import{f as me,r as _e}from"./@vueuse-a3c89100.js";import{v as he}from"./vue-6663b506.js";import{d as ve}from"./docx-preview-32015948.js";import"./@ctrl-43a4208a.js";import"./jszip-1c3a6353.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const ge=""+new URL("word-a6e5b8a9.svg",import.meta.url).href,X=""+new URL("github-540f5a2f.svg",import.meta.url).href,be=""+new URL("vue-5532db34.svg",import.meta.url).href,ye={grid:"~",class:"auto-cols-[max-content] gap-x-4 relative my4 px4 py2 shadow"},we=c("img",{class:"self-center w14 h14 row-span-2",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1),xe={class:"text-lg col-[2]"},ke={class:"text-sm c-gray"},Ae=c("button",{class:"absolute bottom-2 right-16 op-30 hover:op-60"},"é¢„è§ˆ",-1),Ee=c("button",{class:"absolute bottom-2 right-4 op-30 hover:op-60"},"ä¸‹è½½",-1),j=D({__name:"File",props:{name:null,desc:null},setup(e){return(o,t)=>(_(),b("div",ye,[we,c("span",xe,T(e.name),1),c("span",ke,T(e.desc),1),Ae,Ee]))}}),Ce={class:"px4 py1 bg-#0078d7 hover:bg-#005ea9 text-white b-0 leading-6","focus:outline":"~ 2 black offset-1"},M=D({__name:"Button",setup(e){return(o,t)=>{const n=z("reveal-effect");return N((_(),b("button",Ce,[ee(o.$slots,"default")])),[[n]])}}}),Se=D({__name:"SFC",props:{sfc:null,props:null},setup(e){const o=e;let t;const n=k();return te(()=>{if(!o.sfc)return t==null||t.unmount(),t=null;const s=J(async()=>(await A(()=>import("./vue3-sfc-loader-6999a21f.js").then(r=>r.v),["./vue3-sfc-loader-6999a21f.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).loadModule("App.vue",{moduleCache:{vue:he},getFile:()=>o.sfc,addStyle(r){n.value.append(Object.assign(document.createElement("style"),{textContent:r}))}}));t==null||t.unmount(),t=G(()=>oe(s,o.props)),t.mount(n.value)}),(s,r)=>(_(),b("div",{ref_key:"el",ref:n},null,512))}});let $;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),$=e,console.log("ðŸ‘","beforeinstallprompt",e),V.value=!1});const V=k(!0);window.addEventListener("appinstalled",()=>V.value=!0);function Le(){return{prompt:async()=>await($==null?void 0:$.prompt()),installed:V}}async function U(e){const o=(await A(()=>import("./gogocode-235ac559.js").then(n=>n.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default;let t;return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(n,s)=>`{{ ${o(s).find("$_$name").each(f=>!ne(t=f.match.name[0].value)&&f.replaceBy(`data.${t}`)).root().generate({isPretty:!1}).replace(/;$/,"")} }}`)}function H(){let e,o;const t=new Promise((n,s)=>(e=n,o=s));return t.resolve=e,t.reject=o,t}async function Ne(e){const o=Array.from(e||[]).map(t=>t.webkitGetAsEntry()).filter(t=>t!=null).flat();return await Z(o)}async function Z(e,o=[]){for(const t of e)if(t.isDirectory){const n=t.createReader(),s=H();n.readEntries(r=>Z(r,o).then(s.resolve)),await s}else{const n=H();t.file(s=>{const r=t.fullPath.substring(1),f=Object.defineProperty(s,"webkitRelativePath",{value:r});o.push(f),n.resolve(1)}),await n}return o}async function Pe(e){const o=document.createElement("div");await ve.renderAsync(e,o,void 0,{inWrapper:!1});for(const t of o.querySelectorAll("*"))for(let n=t.firstChild;n=n==null?void 0:n.nextSibling;)$e(n,n.previousSibling)&&(n.textContent=n.previousSibling.textContent+n.textContent,n.previousSibling.remove());return o.innerHTML}const Q=e=>e.nodeType==3,q=e=>(e==null?void 0:e.tagName)==="SPAN"&&e.childNodes.length==1&&Q(e.firstChild),Oe=(e,o)=>(e==null?void 0:e.attributes.length)==(o==null?void 0:o.attributes.length)&&(e==null?void 0:e.getAttributeNames().every(t=>(e==null?void 0:e.getAttribute(t))==(o==null?void 0:o.getAttribute(t)))),$e=(e,o)=>q(e)&&q(o)&&Oe(e,o);async function Te(e){const o=p=>{var d;return(d=p.match(/\{\{\s*(.*?)\s*\}\}/))==null?void 0:d[1]},t=p=>p.trim().startsWith("{{")&&p.trim().endsWith("}}"),n=new Set,s=De(e.body,"div");for(const p of s.querySelectorAll("*"))for(const d of p.childNodes){if(!Q(d))continue;const x=d.textContent.replace(`
`,""),l=d.parentElement,a=d.nextSibling,u=o(x);if(!u)continue;d.textContent=await U(x);const i=se(u)?u:null;if(i)if(n.add(i),t(x))if(l.childNodes.length==1)B(l,i);else{const h=e.createElement("span");B(h,i),h.append(d),l.insertBefore(d,a)}else{d.parentNode.removeChild(d);const h=x.match(/(.*?)({{.*?}})(.*)/);l.insertBefore(e.createTextNode(h[1]),a),l.insertBefore(B(e.createElement("span"),i,await U(h[2])),a),l.insertBefore(e.createTextNode(h[3]),a)}}const r=`<template>${s.outerHTML}</template>`,f=`
<script>
export default {
  props: {
    // å“ªäº›å­—æ®µå¯ä»¥åŒå‘ç»‘å®šï¼Œé»˜è®¤å…¨éƒ¨
    vmodels: Array,
    // known data ${JSON.stringify([...n].reduce((p,d)=>(p[d]="",p),{}))}
    data: { type: Object, default: () => ({}) }
  },
  computed: {
    edit() {
      const set = new Set(this.vmodels)
      return (prop) => !this.vmodels || set.has(prop)
    }
  },
  methods: {
    onInput({ target }) {
      const prop = target.getAttribute('name')
      if (this.$set) this.$set(this.data, prop, target.textContent)
      else this.data[prop] = target.textContent
    }
  }
}
<\/script>
`,v=e.querySelectorAll("style"),w=Array.from(v).map(p=>p.textContent).join(`
`),m=Object.assign(e.createElement("style"),{textContent:w});m.setAttribute("scoped",""),m.textContent+=`
  [contenteditable] { display: inline-block; min-width: 2em; background: #7a7a7a12; text-align: center; }
  [contenteditable=false] { cursor: not-allowed; }
  [contenteditable]:hover { background: #7a7a7a33; }
  `;const E=m==null?void 0:m.outerHTML.replace(/<!--/g,"").replace(/-- ?>/g,""),P=(await A(()=>import("./prettierFormat-3a3234c1.js"),["./prettierFormat-3a3234c1.js","./prettier-e74c6c92.js"],import.meta.url)).default;return P([r,f,E].map(p=>p.trim()).join(`

`).trim())}function De(e,o){var n,s;const t=document.createElement(o);return e.getAttributeNames().forEach(r=>t.setAttribute(r,e.getAttribute(r))),t.innerHTML=e.innerHTML,(n=e.parentNode)==null||n.insertBefore(t,e),(s=e.parentNode)==null||s.removeChild(e),t}function B(e,o,t){return o&&(e.id=o,e.setAttribute(":contenteditable",`edit('${o}')`),e.setAttribute("name",o),e.setAttribute("v-on:input","onInput")),t&&(e.textContent=t),e}const g=e=>(pe("data-v-147f31b1"),e=e(),fe(),e),Re={sticky:"",aic:"",spacex4:"",px4:"","top-0":"","w-full":"",h14:"","box-border":"","bg-white":"","shadow-lg":"","z-9":""},Ie=g(()=>c("h1",null,"ðŸ”¨ Docx To Vue",-1)),je=g(()=>c("img",{w12:"",h12:"",src:ge},null,-1)),Me=g(()=>c("div",{"flex-1":""},null,-1)),Be=g(()=>c("img",{src:"https://img.shields.io/github/stars/huodoushigemi/docx2vue.svg?style=flat-square"},null,-1)),Ve=g(()=>c("a",{href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},[c("img",{w10:"",src:X})],-1)),Fe={wrap:"","justify-evenly":""},We={key:0,absolute:"","inset-0":"",col:"",fcc:"",op60:""},Ue=g(()=>c("img",{w20:"",mb4:"",src:X},null,-1)),He={key:1,absolute:"","inset-0":"",fcc:"","text-100":"","c-white":"",class:"bg-#0000002f",style:{"backdrop-filter":"blur(24px)"}},qe={w80:""},ze=["onClick"],Je=g(()=>c("img",{w8:"",py2:"",mr4:"",src:be},null,-1)),Ge=["onClick"],Ke=g(()=>c("h2",null,"ç¤ºä¾‹",-1)),Xe=g(()=>c("p",null,[c("a",{"c-inherit":"",href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},"Please give a â­ï¸ if this project helped you!")],-1)),Ze=D({__name:"App",setup(e){const o=J(async()=>{const l=(await A(()=>import("./monaco-editor-7fb5109a.js").then(u=>u.j),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default,a=(await A(()=>import("./monaco-editor-7fb5109a.js").then(u=>u.a),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default;return window.MonacoEnvironment={getWorker(u,i){return i==="json"?new l:new a}},A(()=>import("./monaco-editor-vue3-6392893e.js"),["./monaco-editor-vue3-6392893e.js","./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)}),t=new Date(1676369544960).toLocaleString(),{prompt:n,installed:s}=Le(),r=k(),{isOverDropZone:f}=me(r,()=>{}),v=k([]),w=k(),m=_e(k(),{sfc:"",props:{}});re(()=>{r.value.addEventListener("drop",async l=>{var i;const u=(await Ne((i=l.dataTransfer)==null?void 0:i.items)).filter(h=>h.name.endsWith(".docx"));if(!u.length)return alert("ä»…æ”¯æŒ docx ç±»åž‹çš„æ–‡ä»¶");v.value=u,P(v.value[0])})});const E=ae({get:()=>JSON.stringify(m.value.props,null,2),set:l=>m.value.props=JSON.parse(l)});async function P(l){const a=await p(l);F(a),w.value=l}function F(l){var i;const a=(i=l.match(/\/\/ known data (.*)/))==null?void 0:i[1],u={vmodels:null,data:{}};a&&(u.data=JSON.parse(a)),m.value={sfc:l,props:u}}async function p(l){const a=await Pe(l).catch(i=>(alert("æ–‡ä»¶å†…å®¹è¯»å–å¤±è´¥"),Promise.reject(i))),u=new DOMParser().parseFromString(a,"text/html");return await Te(u)}async function d(l){const a=await p(l),u=l.name.replace(".docx",".vue");let i=document.createElement("a");i.download=u,i.href=URL.createObjectURL(new Blob([a])),i.click()}async function x(){for(const l of v.value)await d(l)}return(l,a)=>{const u=z("reveal-effect");return _(),b(W,null,[c("header",Re,[Ie,je,Me,Be,Ve,y(s)?C("",!0):(_(),R(M,{key:0,onClick:y(n)},{default:I(()=>[L("ä¸‹è½½")]),_:1},8,["onClick"]))]),c("main",Fe,[c("article",{ref_key:"dropRef",ref:r,relative:"",my4:"","min-w595pt":"","min-h-842pt":"","bg-white":"","z-1":"",style:{"box-shadow":"0px 5px 30px -10px #0000004f"}},[S(Se,ie(y(m),{w595pt:""}),null,16),w.value?C("",!0):(_(),b("div",We,[Ue,L("å°† docx æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ‹–æ‹½è‡³æ­¤")])),y(f)?(_(),b("div",He,"+")):C("",!0)],512),c("div",qe,[S(y(o),{"animate-fade-in":"",value:y(E),"onUpdate:value":a[0]||(a[0]=i=>le(E)?E.value=i:null),language:"json",height:300,options:{minimap:{enabled:!1},lineNumbers:"off"},class:"shadow",my4:""},null,8,["value"]),v.value.length?(_(),R(M,{key:0,mt4:"",mb2:"",onClick:x},{default:I(()=>[L("ä¸‹è½½å…¨éƒ¨")]),_:1})):C("",!0),v.value.length?(_(),R(M,{key:1,ml2:"",mt4:"",mb2:"",onClick:a[1]||(a[1]=i=>{v.value=[],m.value=null,w.value=null})},{default:I(()=>[L("X")]),_:1})):C("",!0),(_(!0),b(W,null,ce(v.value,(i,h)=>N((_(),b("div",{key:h,class:ue(["aic px4 mb1 leading-8 bg-#80808033 hover:bg-#0078d72f cursor-pointer",i==w.value&&"bg-#0078d72f!"]),onClick:Y=>P(i)},[Je,L(" "+T(i.webkitRelativePath.replace(".docx",".vue"))+" ",1),c("button",{mla:"","op-30":"","hover:op-60":"",onClick:de(Y=>d(i),["stop"])},"ä¸‹è½½",8,Ge)],10,ze)),[[u]])),128))]),a[2]||(O(-1),a[2]=c("article",{"min-w75":"",px4:""},[Ke,N(S(j,{name:"exmaple.doc",desc:"ç¤ºä¾‹æ–‡ä»¶"},null,512),[[u]]),N(S(j,{name:"exmaple-img.doc",desc:"å¸¦å›¾ç‰‡çš„ç¤ºä¾‹"},null,512),[[u]]),N(S(j,{name:"exmaple-more.doc",desc:"æ›´å¤šçš„ç¤ºä¾‹"},null,512),[[u]])]),O(1),a[2])]),a[3]||(O(-1),a[3]=c("footer",{col:"",fcc:"",mt8:"",h40:"","bg-gray-300":""},[c("p",null,[c("b",null,"Last updated: "+T(y(t)),1)]),Xe]),O(1),a[3])],64)}}});const Qe=(e,o)=>{const t=e.__vccOpts||e;for(const[n,s]of o)t[n]=s;return t},Ye=Qe(Ze,[["__scopeId","data-v-147f31b1"]]);window.addEventListener("appinstalled",()=>console.log("appinstalled"));K.setDefaultProps({borderWidth:2,borderColor:"#0000002f"});G(Ye).use(K).mount("#app");
