import{U as D,ay as y,A as w,D as l,aX as T,bm as N,aI as Q,aK as H,r as x,e as Y,Q as q,x as z,a4 as ee,bs as te,bt as oe,o as ne,c as se,O as E,bk as O,u as R,aj as re,N as C,z as P,i as ie,y as M,F as V,aH as ae,ak as le,bp as ce,aO as W,aC as ue,az as de}from"./@vue-2f9bc0b9.js";import{R as J}from"./vue-reveal-effect-318013a5.js";import{_ as S}from"./monaco-editor-7fb5109a.js";import{f as pe,r as fe}from"./@vueuse-a3c89100.js";import{v as me}from"./vue-6663b506.js";import{d as he}from"./docx-preview-32015948.js";import"./@ctrl-43a4208a.js";import"./jszip-1c3a6353.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const ve=""+new URL("github-540f5a2f.svg",import.meta.url).href,_e=""+new URL("vue-5532db34.svg",import.meta.url).href,ge={grid:"~",class:"auto-cols-[max-content] gap-x-4 relative my4 px4 py2 shadow"},be=l("img",{class:"self-center w14 h14 row-span-2",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1),ye={class:"text-lg col-[2]"},we={class:"text-sm c-gray"},xe=l("button",{class:"absolute bottom-2 right-16 op-30 hover:op-60"},"È¢ÑËßà",-1),ke=l("button",{class:"absolute bottom-2 right-4 op-30 hover:op-60"},"‰∏ãËΩΩ",-1),I=D({__name:"File",props:{name:null,desc:null},setup(e){return(o,t)=>(y(),w("div",ge,[be,l("span",ye,T(e.name),1),l("span",we,T(e.desc),1),xe,ke]))}}),Ee={class:"px4 py1 bg-#0078d7 hover:bg-#005ea9 text-white b-0 leading-6","focus:outline":"~ 2 black offset-1"},$=D({__name:"Button",setup(e){return(o,t)=>{const n=H("reveal-effect");return N((y(),w("button",Ee,[Q(o.$slots,"default")])),[[n]])}}}),Re=D({__name:"SFC",props:{sfc:null,props:null},setup(e){const o=e;let t;const n=x();return Y(()=>{if(!o.sfc)return t==null||t.unmount(),t=null;const s=q(async()=>(await S(()=>import("./vue3-sfc-loader-6999a21f.js").then(r=>r.v),["./vue3-sfc-loader-6999a21f.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).loadModule("App.vue",{moduleCache:{vue:me},getFile:()=>o.sfc,addStyle(r){n.value.append(Object.assign(document.createElement("style"),{textContent:r}))}}));t==null||t.unmount(),t=z(()=>ee(s,o.props)),t.mount(n.value)}),(s,r)=>(y(),w("div",{ref_key:"el",ref:n},null,512))}});let Se;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),e=e,console.log("üëç","beforeinstallprompt",e)});const G=x(!1);window.addEventListener("appinstalled",()=>G.value=!0);function Ae(){return{prompt:()=>Se.prompt(),installed:G}}async function B(e){const o=(await S(()=>import("./gogocode-235ac559.js").then(n=>n.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default;let t;return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(n,s)=>`{{ ${o(s).find("$_$name").each(m=>!te(t=m.match.name[0].value)&&m.replaceBy(`data.${t}`)).root().generate({isPretty:!1}).replace(/;$/,"")} }}`)}function F(){let e,o;const t=new Promise((n,s)=>(e=n,o=s));return t.resolve=e,t.reject=o,t}async function Ce(e){const o=Array.from(e||[]).map(t=>t.webkitGetAsEntry()).filter(t=>t!=null).flat();return await K(o)}async function K(e,o=[]){for(const t of e)if(t.isDirectory){const n=t.createReader(),s=F();n.readEntries(r=>K(r,o).then(s.resolve)),await s}else{const n=F();t.file(s=>{const r=t.fullPath.substring(1),m=Object.defineProperty(s,"webkitRelativePath",{value:r});o.push(m),n.resolve(1)}),await n}return o}async function Le(e){const o=document.createElement("div");await he.renderAsync(e,o,void 0,{inWrapper:!1});for(const t of o.querySelectorAll("*"))for(let n=t.firstChild;n=n==null?void 0:n.nextSibling;)Oe(n,n.previousSibling)&&(n.textContent=n.previousSibling.textContent+n.textContent,n.previousSibling.remove());return o.innerHTML}const X=e=>e.nodeType==3,U=e=>(e==null?void 0:e.tagName)==="SPAN"&&e.childNodes.length==1&&X(e.firstChild),Ne=(e,o)=>(e==null?void 0:e.attributes.length)==(o==null?void 0:o.attributes.length)&&(e==null?void 0:e.getAttributeNames().every(t=>(e==null?void 0:e.getAttribute(t))==(o==null?void 0:o.getAttribute(t)))),Oe=(e,o)=>U(e)&&U(o)&&Ne(e,o);async function Pe(e){const o=u=>{var f;return(f=u.match(/\{\{\s*(.*?)\s*\}\}/))==null?void 0:f[1]},t=u=>u.trim().startsWith("{{")&&u.trim().endsWith("}}"),n=new Set,s=We(e.body,"div");for(const u of s.querySelectorAll("*"))for(const f of u.childNodes){if(!X(f))continue;const v=f.textContent.replace(`
`,""),c=f.parentElement,i=f.nextSibling,d=o(v);if(!d)continue;f.textContent=await B(v);const a=oe(d)?d:null;if(a)if(n.add(a),t(v))if(c.childNodes.length==1)j(c,a);else{const b=e.createElement("span");j(b,a),b.append(f),c.insertBefore(f,i)}else{f.parentNode.removeChild(f);const b=v.match(/(.*?)({{.*?}})(.*)/);c.insertBefore(e.createTextNode(b[1]),i),c.insertBefore(j(e.createElement("span"),a,await B(b[2])),i),c.insertBefore(e.createTextNode(b[3]),i)}}const r=`<template>${s.outerHTML}</template>`,m=`
<script>
export default {
  props: {
    // Âì™‰∫õÂ≠óÊÆµÂèØ‰ª•ÂèåÂêëÁªëÂÆöÔºåÈªòËÆ§ÂÖ®ÈÉ®
    vmodels: Array,
    // known data ${JSON.stringify([...n].reduce((u,f)=>(u[f]="",u),{}))}
    data: { type: Object, default: () => ({}) }
  },
  computed: {
    edit() {
      const set = new Set(this.vmodels)
      return (prop) => !this.vmodels || set.has(prop)
    }
  },
  methods: {
    onInput({ target }) {
      const prop = target.getAttribute('name')
      if (this.$set) this.$set(this.data, prop, target.textContent)
      else this.data[prop] = target.textContent
    }
  }
}
<\/script>
`,p=e.querySelectorAll("style"),_=Array.from(p).map(u=>u.textContent).join(`
`),h=Object.assign(e.createElement("style"),{textContent:_});h.setAttribute("scoped",""),h.textContent+=`
  [contenteditable] { display: inline-block; min-width: 2em; background: #7a7a7a12; text-align: center; }
  [contenteditable=false] { cursor: not-allowed; }
  [contenteditable]:hover { background: #7a7a7a33; }
  `;const k=h==null?void 0:h.outerHTML.replace(/<!--/g,"").replace(/-- ?>/g,""),A=(await S(()=>import("./prettierFormat-3a3234c1.js"),["./prettierFormat-3a3234c1.js","./prettier-e74c6c92.js"],import.meta.url)).default;return A([r,m,k].map(u=>u.trim()).join(`

`).trim())}function We(e,o){var n,s;const t=document.createElement(o);return e.getAttributeNames().forEach(r=>t.setAttribute(r,e.getAttribute(r))),t.innerHTML=e.innerHTML,(n=e.parentNode)==null||n.insertBefore(t,e),(s=e.parentNode)==null||s.removeChild(e),t}function j(e,o,t){return o&&(e.id=o,e.setAttribute(":contenteditable",`edit('${o}')`),e.setAttribute("name",o),e.setAttribute("v-on:input","onInput")),t&&(e.textContent=t),e}const g=e=>(ue("data-v-7f4874b8"),e=e(),de(),e),$e={sticky:"",aic:"",spacex4:"",px4:"","top-0":"","w-full":"",h14:"","box-border":"","bg-white":"","shadow-lg":"","z-9":""},Te=g(()=>l("h1",null,"üî® Docx To Vue",-1)),De=g(()=>l("img",{w12:"",h12:"",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1)),Ie=g(()=>l("div",{"flex-1":""},null,-1)),je=g(()=>l("img",{src:"https://img.shields.io/github/stars/huodoushigemi/docx2vue.svg?style=flat-square"},null,-1)),Me=g(()=>l("a",{href:"https://github.com/huodoushigemi/doc2vue",target:"_blank"},[l("img",{w10:"",src:ve})],-1)),Ve={wrap:"","justify-evenly":""},Be={key:0,absolute:"","inset-0":"",col:"",fcc:"",op60:""},Fe=g(()=>l("img",{w20:"",mb4:"",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1)),Ue={key:1,absolute:"","inset-0":"",fcc:"","text-100":"","c-white":"",class:"bg-#0000002f",style:{"backdrop-filter":"blur(24px)"}},He={w80:""},qe=["onClick"],ze=g(()=>l("img",{w8:"",py2:"",mr4:"",src:_e},null,-1)),Je=["onClick"],Ge=g(()=>l("h2",null,"‰∏ãËΩΩ",-1)),Ke=g(()=>l("div",{mt1:"","text-xs":"","c-gray":""},"Windows 64 ‰Ωç",-1)),Xe=g(()=>l("h2",null,"Á§∫‰æã",-1)),Ze=g(()=>l("p",null,[l("a",{"c-inherit":"",href:"https://github.com/huodoushigemi/doc2vue",target:"_blank"},"Please give a ‚≠êÔ∏è if this project helped you!")],-1)),Qe=D({__name:"App",setup(e){const o=q(async()=>{const c=(await S(()=>import("./monaco-editor-7fb5109a.js").then(d=>d.j),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default,i=(await S(()=>import("./monaco-editor-7fb5109a.js").then(d=>d.a),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default;return window.MonacoEnvironment={getWorker(d,a){return a==="json"?new c:new i}},S(()=>import("./monaco-editor-vue3-6392893e.js"),["./monaco-editor-vue3-6392893e.js","./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)}),t=new Date(1676364384276).toLocaleString(),{prompt:n,installed:s}=Ae(),r=x(),{isOverDropZone:m}=pe(r,()=>{}),p=x([]),_=x(),h=fe(x(),{sfc:"",props:{}});ne(()=>{r.value.addEventListener("drop",async c=>{var a;const d=(await Ce((a=c.dataTransfer)==null?void 0:a.items)).filter(b=>b.name.endsWith(".docx"));if(!d.length)return alert("‰ªÖÊîØÊåÅ docx Á±ªÂûãÁöÑÊñá‰ª∂");p.value=d,A(p.value[0])})});const k=se({get:()=>JSON.stringify(h.value.props,null,2),set:c=>h.value.props=JSON.parse(c)});async function A(c){const i=await u(c);L(i),_.value=c}function L(c){var a;const i=(a=c.match(/\/\/ known data (.*)/))==null?void 0:a[1],d={vmodels:null,data:{}};i&&(d.data=JSON.parse(i)),h.value={sfc:c,props:d}}async function u(c){const i=await Le(c).catch(a=>(alert("Êñá‰ª∂ÂÜÖÂÆπËØªÂèñÂ§±Ë¥•"),Promise.reject(a))),d=new DOMParser().parseFromString(i,"text/html");return await Pe(d)}async function f(c){const i=await u(c),d=c.name.replace(".docx",".vue");let a=document.createElement("a");a.download=d,a.href=URL.createObjectURL(new Blob([i])),a.click()}async function v(){for(const c of p.value)await f(c)}return(c,i)=>{const d=H("reveal-effect");return y(),w(V,null,[l("header",$e,[Te,De,Ie,je,Me,E($,{onClick:R(n)},{default:O(()=>[C("‰∏ãËΩΩ")]),_:1},8,["onClick"])]),l("main",Ve,[l("article",{ref_key:"dropRef",ref:r,relative:"",my4:"","min-w595pt":"","min-h-842pt":"","bg-white":"","z-1":"",style:{"box-shadow":"0px 5px 30px -10px #0000004f"}},[E(Re,re(R(h),{w595pt:""}),null,16),_.value?P("",!0):(y(),w("div",Be,[Fe,C("Â∞Ü docx Êñá‰ª∂ÊàñÊñá‰ª∂Â§πÊãñÊãΩËá≥Ê≠§")])),R(m)?(y(),w("div",Ue,"+")):P("",!0)],512),l("div",He,[E(R(o),{"animate-fade-in":"",value:R(k),"onUpdate:value":i[0]||(i[0]=a=>ie(k)?k.value=a:null),language:"json",height:300,options:{minimap:{enabled:!1},lineNumbers:"off"},class:"shadow",my4:""},null,8,["value"]),p.value.length?(y(),M($,{key:0,mt4:"",mb2:"",onClick:v},{default:O(()=>[C("‰∏ãËΩΩÂÖ®ÈÉ®")]),_:1})):P("",!0),p.value.length?(y(),M($,{key:1,ml2:"",mt4:"",mb2:"",onClick:i[1]||(i[1]=a=>{p.value=[],h.value=null,_.value=null})},{default:O(()=>[C("X")]),_:1})):P("",!0),(y(!0),w(V,null,ae(p.value,(a,b)=>N((y(),w("div",{key:b,class:le(["aic px4 mb1 leading-8 bg-#80808033 hover:bg-#0078d72f cursor-pointer",a==_.value&&"bg-#0078d72f!"]),onClick:Z=>A(a)},[ze,C(" "+T(a.webkitRelativePath.replace(".docx",".vue"))+" ",1),l("button",{mla:"","op-30":"","hover:op-60":"",onClick:ce(Z=>f(a),["stop"])},"‰∏ãËΩΩ",8,Je)],10,qe)),[[d]])),128))]),i[2]||(W(-1),i[2]=l("article",{"min-w75":"",px4:""},[Ge,E($,{onClick:R(n)},{default:O(()=>[C("‰∏ãËΩΩ")]),_:1},8,["onClick"]),Ke,Xe,N(E(I,{name:"exmaple.doc",desc:"Á§∫‰æãÊñá‰ª∂"},null,512),[[d]]),N(E(I,{name:"exmaple-img.doc",desc:"Â∏¶ÂõæÁâáÁöÑÁ§∫‰æã"},null,512),[[d]]),N(E(I,{name:"exmaple-more.doc",desc:"Êõ¥Â§öÁöÑÁ§∫‰æã"},null,512),[[d]])]),W(1),i[2])]),i[3]||(W(-1),i[3]=l("footer",{col:"",fcc:"",mt8:"",h40:"","bg-gray-300":""},[l("p",null,[l("b",null,"Last updated: "+T(R(t)),1)]),Ze]),W(1),i[3])],64)}}});const Ye=(e,o)=>{const t=e.__vccOpts||e;for(const[n,s]of o)t[n]=s;return t},et=Ye(Qe,[["__scopeId","data-v-7f4874b8"]]);function tt(e={}){const{immediate:o=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:s,onRegisteredSW:r,onRegisterError:m}=e;let p,_,h;const k=async(L=!0)=>{await _,await(h==null?void 0:h())};async function A(){if("serviceWorker"in navigator){const{Workbox:L}=await S(()=>import("./workbox-window-295a6886.js"),[],import.meta.url);p=new L("./sw.js",{scope:"./",type:"classic"}),h=async()=>{await(p==null?void 0:p.messageSkipWaiting())};{let u=!1;const f=()=>{u=!0,p==null||p.addEventListener("controlling",v=>{v.isUpdate&&window.location.reload()}),t==null||t()};p.addEventListener("installed",v=>{typeof v.isUpdate>"u"?typeof v.isExternal<"u"?v.isExternal?f():!u&&(n==null||n()):v.isExternal?window.location.reload():!u&&(n==null||n()):v.isUpdate||n==null||n()}),p.addEventListener("waiting",f),p.addEventListener("externalwaiting",f)}p.register({immediate:o}).then(u=>{r?r("./sw.js",u):s==null||s(u)}).catch(u=>{m==null||m(u)})}}return _=A(),k}function ot(e={}){const{immediate:o=!0,onNeedRefresh:t,onOfflineReady:n,onRegistered:s,onRegisteredSW:r,onRegisterError:m}=e,p=x(!1),_=x(!1);return{updateServiceWorker:tt({immediate:o,onNeedRefresh(){p.value=!0,t==null||t()},onOfflineReady(){_.value=!0,n==null||n()},onRegistered:s,onRegisteredSW:r,onRegisterError:m}),offlineReady:_,needRefresh:p}}window.addEventListener("appinstalled",()=>console.log("appinstalled"));ot({onRegisteredSW(){console.log("onRegisteredSW")},onNeedRefresh(){console.log("onNeedRefresh"),confirm("ÁΩëÈ°µÂÜÖÂÆπÂ∑≤ËøáÊó∂ÔºåÊòØÂê¶Âà∑Êñ∞È°µÈù¢")&&location.reload()},onRegisterError(e){console.error("onRegisterError",e)},onOfflineReady(){console.log("onOfflineReady")}});J.setDefaultProps({borderWidth:2,borderColor:"#0000002f"});z(et).use(J).mount("#app");
