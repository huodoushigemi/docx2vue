import{U as D,ay as h,A as g,D as d,aX as T,bm as O,aI as X,aK as H,r as x,e as Z,Q as z,x as J,a4 as Q,bs as Y,bt as ee,o as te,c as oe,O as w,bk as P,aj as ne,u as N,N as A,z as W,i as se,y as M,F as V,aH as re,ak as ae,bp as ie,aO as L,aC as le,az as ce}from"./@vue-2f9bc0b9.js";import{R as q}from"./vue-reveal-effect-318013a5.js";import{_ as k}from"./monaco-editor-6351b683.js";import{f as de,r as ue}from"./@vueuse-a3c89100.js";import{v as fe}from"./vue-6663b506.js";import{d as pe}from"./docx-preview-32015948.js";import"./@ctrl-43a4208a.js";import"./jszip-1c3a6353.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const me="/assets/github-540f5a2f.svg",_e="/assets/vue-5532db34.svg",he={grid:"~",class:"auto-cols-[max-content] gap-x-4 relative my4 px4 py2 shadow"},ve=d("img",{class:"self-center w14 h14 row-span-2",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1),ge={class:"text-lg col-[2]"},be={class:"text-sm c-gray"},ye=d("button",{class:"absolute bottom-2 right-16 op-30 hover:op-60"},"预览",-1),we=d("button",{class:"absolute bottom-2 right-4 op-30 hover:op-60"},"下载",-1),I=D({__name:"File",props:{name:null,desc:null},setup(e){return(o,t)=>(h(),g("div",he,[ve,d("span",ge,T(e.name),1),d("span",be,T(e.desc),1),ye,we]))}}),xe={class:"px4 py1 bg-#0078d7 hover:bg-#005ea9 text-white b-0 leading-6","focus:outline":"~ 2 black offset-1"},$=D({__name:"Button",setup(e){return(o,t)=>{const n=H("reveal-effect");return O((h(),g("button",xe,[X(o.$slots,"default")])),[[n]])}}}),ke=D({__name:"SFC",props:{sfc:null,props:null},setup(e){const o=e;let t;const n=x();return Z(()=>{if(!o.sfc)return t==null||t.unmount(),t=null;const s=z(async()=>(await k(()=>import("./vue3-sfc-loader-6999a21f.js").then(r=>r.v),["assets/vue3-sfc-loader-6999a21f.js","assets/docx-preview-32015948.js","assets/jszip-1c3a6353.js"])).loadModule("App.vue",{moduleCache:{vue:fe},getFile:()=>o.sfc,addStyle(r){n.value.append(Object.assign(document.createElement("style"),{textContent:r}))}}));t==null||t.unmount(),t=J(()=>Q(s,o.props)),t.mount(n.value)}),(s,r)=>(h(),g("div",{ref_key:"el",ref:n},null,512))}});async function B(e){const o=(await k(()=>import("./gogocode-235ac559.js").then(n=>n.g),["assets/gogocode-235ac559.js","assets/docx-preview-32015948.js","assets/jszip-1c3a6353.js"])).default;let t;return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(n,s)=>`{{ ${o(s).find("$_$name").each(f=>!Y(t=f.match.name[0].value)&&f.replaceBy(`data.${t}`)).root().generate({isPretty:!1}).replace(/;$/,"")} }}`)}function F(){let e,o;const t=new Promise((n,s)=>(e=n,o=s));return t.resolve=e,t.reject=o,t}async function Ee(e){const o=Array.from(e||[]).map(t=>t.webkitGetAsEntry()).filter(t=>t!=null).flat();return await G(o)}async function G(e,o=[]){for(const t of e)if(t.isDirectory){const n=t.createReader(),s=F();n.readEntries(r=>G(r,o).then(s.resolve)),await s}else{const n=F();t.file(s=>{const r=t.fullPath.substring(1),f=Object.defineProperty(s,"webkitRelativePath",{value:r});o.push(f),n.resolve(1)}),await n}return o}async function Re(e){const o=document.createElement("div");await pe.renderAsync(e,o,void 0,{inWrapper:!1});for(const t of o.querySelectorAll("*"))for(let n=t.firstChild;n=n==null?void 0:n.nextSibling;)Ae(n,n.previousSibling)&&(n.textContent=n.previousSibling.textContent+n.textContent,n.previousSibling.remove());return o.innerHTML}const K=e=>e.nodeType==3,U=e=>(e==null?void 0:e.tagName)==="SPAN"&&e.childNodes.length==1&&K(e.firstChild),Se=(e,o)=>(e==null?void 0:e.attributes.length)==(o==null?void 0:o.attributes.length)&&(e==null?void 0:e.getAttributeNames().every(t=>(e==null?void 0:e.getAttribute(t))==(o==null?void 0:o.getAttribute(t)))),Ae=(e,o)=>U(e)&&U(o)&&Se(e,o);async function Ce(e){const o=u=>{var a;return(a=u.match(/\{\{\s*(.*?)\s*\}\}/))==null?void 0:a[1]},t=u=>u.trim().startsWith("{{")&&u.trim().endsWith("}}"),n=new Set,s=Ne(e.body,"div");for(const u of s.querySelectorAll("*"))for(const a of u.childNodes){if(!K(a))continue;const i=a.textContent.replace(`
`,""),l=a.parentElement,c=a.nextSibling,b=o(i);if(!b)continue;a.textContent=await B(i);const y=ee(b)?b:null;if(y)if(n.add(y),t(i))if(l.childNodes.length==1)j(l,y);else{const S=e.createElement("span");j(S,y),S.append(a),l.insertBefore(a,c)}else{a.parentNode.removeChild(a);const S=i.match(/(.*?)({{.*?}})(.*)/);l.insertBefore(e.createTextNode(S[1]),c),l.insertBefore(j(e.createElement("span"),y,await B(S[2])),c),l.insertBefore(e.createTextNode(S[3]),c)}}const r=`<template>${s.outerHTML}</template>`,f=`
<script>
export default {
  props: {
    // 哪些字段可以双向绑定，默认全部
    vmodels: Array,
    // known data ${JSON.stringify([...n].reduce((u,a)=>(u[a]="",u),{}))}
    data: { type: Object, default: () => ({}) }
  },
  computed: {
    edit() {
      const set = new Set(this.vmodels)
      return (prop) => !this.vmodels || set.has(prop)
    }
  },
  methods: {
    onInput({ target }) {
      const prop = target.getAttribute('name')
      if (this.$set) this.$set(this.data, prop, target.textContent)
      else this.data[prop] = target.textContent
    }
  }
}
<\/script>
`,p=e.querySelectorAll("style"),_=Array.from(p).map(u=>u.textContent).join(`
`),m=Object.assign(e.createElement("style"),{textContent:_});m.setAttribute("scoped",""),m.textContent+=`
  [contenteditable] { display: inline-block; min-width: 2em; background: #7a7a7a12; text-align: center; }
  [contenteditable=false] { cursor: not-allowed; }
  [contenteditable]:hover { background: #7a7a7a33; }
  `;const C=m==null?void 0:m.outerHTML.replace(/<!--/g,"").replace(/-- ?>/g,""),E=(await k(()=>import("./prettierFormat-3a3234c1.js"),["assets/prettierFormat-3a3234c1.js","assets/prettier-e74c6c92.js"])).default;return E([r,f,C].map(u=>u.trim()).join(`

`).trim())}function Ne(e,o){var n,s;const t=document.createElement(o);return e.getAttributeNames().forEach(r=>t.setAttribute(r,e.getAttribute(r))),t.innerHTML=e.innerHTML,(n=e.parentNode)==null||n.insertBefore(t,e),(s=e.parentNode)==null||s.removeChild(e),t}function j(e,o,t){return o&&(e.id=o,e.setAttribute(":contenteditable",`edit('${o}')`),e.setAttribute("name",o),e.setAttribute("v-on:input","onInput")),t&&(e.textContent=t),e}const v=e=>(le("data-v-abd3b856"),e=e(),ce(),e),Oe={sticky:"",aic:"",spacex4:"",px4:"","top-0":"","w-full":"",h14:"","box-border":"","bg-white":"","shadow-lg":"","z-9":""},Pe=v(()=>d("h1",null,"🔨 Docx To Vue",-1)),We=v(()=>d("img",{w12:"",h12:"",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1)),Le=v(()=>d("div",{"flex-1":""},null,-1)),$e=v(()=>d("a",{href:"https://github.com/huodoushigemi/doc2vue",target:"_blank"},[d("img",{w10:"",src:me})],-1)),Te={wrap:"","justify-evenly":""},De={key:0,absolute:"","inset-0":"",col:"",fcc:"",op60:""},Ie=v(()=>d("img",{w20:"",mb4:"",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1)),je={key:1,absolute:"","inset-0":"",fcc:"","text-100":"","c-white":"",class:"bg-#0000002f",style:{"backdrop-filter":"blur(24px)"}},Me={w80:""},Ve=["onClick"],Be=v(()=>d("img",{w8:"",py2:"",mr4:"",src:_e},null,-1)),Fe=["onClick"],Ue=v(()=>d("h2",null,"下载",-1)),He=v(()=>d("div",{mt1:"","text-xs":"","c-gray":""},"Windows 64 位",-1)),ze=v(()=>d("h2",null,"示例",-1)),Je=v(()=>d("p",null,[d("a",{"c-inherit":"",href:"https://github.com/huodoushigemi/doc2vue",target:"_blank"},"Please give a ⭐️ if this project helped you!")],-1)),qe=D({__name:"App",setup(e){const o=z(async()=>{const a=(await k(()=>import("./monaco-editor-6351b683.js").then(l=>l.j),["assets/monaco-editor-6351b683.js","assets/monaco-editor-19357064.css"])).default,i=(await k(()=>import("./monaco-editor-6351b683.js").then(l=>l.a),["assets/monaco-editor-6351b683.js","assets/monaco-editor-19357064.css"])).default;return window.MonacoEnvironment={getWorker(l,c){return c==="json"?new a:new i}},k(()=>import("./monaco-editor-vue3-39bc3c61.js"),["assets/monaco-editor-vue3-39bc3c61.js","assets/monaco-editor-6351b683.js","assets/monaco-editor-19357064.css"])}),t=new Date(1676359055606).toLocaleString(),n=x(),{isOverDropZone:s}=de(n,()=>{}),r=x([]),f=x(),p=ue(x(),{sfc:"",props:{}});te(()=>{n.value.addEventListener("drop",async a=>{var c;const l=(await Ee((c=a.dataTransfer)==null?void 0:c.items)).filter(b=>b.name.endsWith(".docx"));if(!l.length)return alert("仅支持 docx 类型的文件");r.value=l,m(r.value[0])})});const _=oe({get:()=>JSON.stringify(p.value.props,null,2),set:a=>p.value.props=JSON.parse(a)});async function m(a){const i=await E(a);C(i),f.value=a}function C(a){var c;const i=(c=a.match(/\/\/ known data (.*)/))==null?void 0:c[1],l={vmodels:null,data:{}};i&&(l.data=JSON.parse(i)),p.value={sfc:a,props:l}}async function E(a){const i=await Re(a).catch(c=>(alert("文件内容读取失败"),Promise.reject(c))),l=new DOMParser().parseFromString(i,"text/html");return await Ce(l)}async function R(a){const i=await E(a),l=a.name.replace(".docx",".vue");let c=document.createElement("a");c.download=l,c.href=URL.createObjectURL(new Blob([i])),c.click()}async function u(){for(const a of r.value)await R(a)}return(a,i)=>{const l=H("reveal-effect");return h(),g(V,null,[d("header",Oe,[Pe,We,Le,$e,w($,null,{default:P(()=>[A("下载")]),_:1})]),d("main",Te,[d("article",{ref_key:"dropRef",ref:n,relative:"",my4:"","min-w595pt":"","min-h-842pt":"","bg-white":"","z-1":"",style:{"box-shadow":"0px 5px 30px -10px #0000004f"}},[w(ke,ne(N(p),{w595pt:""}),null,16),f.value?W("",!0):(h(),g("div",De,[Ie,A("将 docx 文件或文件夹拖拽至此")])),N(s)?(h(),g("div",je,"+")):W("",!0)],512),d("div",Me,[w(N(o),{"animate-fade-in":"",value:N(_),"onUpdate:value":i[0]||(i[0]=c=>se(_)?_.value=c:null),language:"json",height:300,options:{minimap:{enabled:!1},lineNumbers:"off"},class:"shadow",my4:""},null,8,["value"]),r.value.length?(h(),M($,{key:0,mt4:"",mb2:"",onClick:u},{default:P(()=>[A("下载全部")]),_:1})):W("",!0),r.value.length?(h(),M($,{key:1,ml2:"",mt4:"",mb2:"",onClick:i[1]||(i[1]=c=>{r.value=[],p.value=null,f.value=null})},{default:P(()=>[A("X")]),_:1})):W("",!0),(h(!0),g(V,null,re(r.value,(c,b)=>O((h(),g("div",{key:b,class:ae(["aic px4 mb1 leading-8 bg-#80808033 hover:bg-#0078d72f cursor-pointer",c==f.value&&"bg-#0078d72f!"]),onClick:y=>m(c)},[Be,A(" "+T(c.webkitRelativePath.replace(".docx",".vue"))+" ",1),d("button",{mla:"","op-30":"","hover:op-60":"",onClick:ie(y=>R(c),["stop"])},"下载",8,Fe)],10,Ve)),[[l]])),128))]),i[2]||(L(-1),i[2]=d("article",{"min-w75":"",px4:""},[Ue,w($,null,{default:P(()=>[A("下载 doc2vue.exe")]),_:1}),He,ze,O(w(I,{name:"exmaple.doc",desc:"示例文件"},null,512),[[l]]),O(w(I,{name:"exmaple-img.doc",desc:"带图片的示例"},null,512),[[l]]),O(w(I,{name:"exmaple-more.doc",desc:"更多的示例"},null,512),[[l]])]),L(1),i[2])]),i[3]||(L(-1),i[3]=d("footer",{col:"",fcc:"",mt8:"",h40:"","bg-gray-300":""},[d("p",null,[d("b",null,"Last updated: "+T(N(t)),1)]),Je]),L(1),i[3])],64)}}});const Ge=(e,o)=>{const t=e.__vccOpts||e;for(const[n,s]of o)t[n]=s;return t},Ke=Ge(qe,[["__scopeId","data-v-abd3b856"]]);function Xe(e={}){const{immediate:o=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:s,onRegisteredSW:r,onRegisterError:f}=e;let p,_,m;const C=async(R=!0)=>{await _,await(m==null?void 0:m())};async function E(){if("serviceWorker"in navigator){const{Workbox:R}=await k(()=>import("./workbox-window-295a6886.js"),[]);p=new R("/sw.js",{scope:"/",type:"classic"}),m=async()=>{await(p==null?void 0:p.messageSkipWaiting())};{let u=!1;const a=()=>{u=!0,p==null||p.addEventListener("controlling",i=>{i.isUpdate&&window.location.reload()}),t==null||t()};p.addEventListener("installed",i=>{typeof i.isUpdate>"u"?typeof i.isExternal<"u"?i.isExternal?a():!u&&(n==null||n()):i.isExternal?window.location.reload():!u&&(n==null||n()):i.isUpdate||n==null||n()}),p.addEventListener("waiting",a),p.addEventListener("externalwaiting",a)}p.register({immediate:o}).then(u=>{r?r("/sw.js",u):s==null||s(u)}).catch(u=>{f==null||f(u)})}}return _=E(),C}function Ze(e={}){const{immediate:o=!0,onNeedRefresh:t,onOfflineReady:n,onRegistered:s,onRegisteredSW:r,onRegisterError:f}=e,p=x(!1),_=x(!1);return{updateServiceWorker:Xe({immediate:o,onNeedRefresh(){p.value=!0,t==null||t()},onOfflineReady(){_.value=!0,n==null||n()},onRegistered:s,onRegisteredSW:r,onRegisterError:f}),offlineReady:_,needRefresh:p}}Ze({onRegisteredSW(){console.log("onRegisteredSW")},onNeedRefresh(){console.log("onNeedRefresh"),confirm("网页内容已过时，是否刷新页面")&&location.reload()},onRegisterError(e){console.error("onRegisterError",e)},onOfflineReady(){console.log("onOfflineReady")}});q.setDefaultProps({borderWidth:2,borderColor:"#0000002f"});J(Ke).use(q).mount("#app");
