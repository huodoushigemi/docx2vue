import{U as D,ay as _,A as g,D as u,aX as T,bm as O,aI as X,aK as H,r as x,e as Z,Q as z,x as J,a4 as Q,bs as Y,bt as ee,o as te,c as oe,O as w,bk as L,aj as ne,u as N,N as A,z as P,i as se,y as M,F as V,aH as re,ak as ie,bp as ae,aO as W,aC as le,az as ce}from"./@vue-2f9bc0b9.js";import{R as q}from"./vue-reveal-effect-318013a5.js";import{_ as k}from"./monaco-editor-7fb5109a.js";import{f as ue,r as de}from"./@vueuse-a3c89100.js";import{v as fe}from"./vue-6663b506.js";import{d as pe}from"./docx-preview-32015948.js";import"./@ctrl-43a4208a.js";import"./jszip-1c3a6353.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const me=""+new URL("github-540f5a2f.svg",import.meta.url).href,he=""+new URL("vue-5532db34.svg",import.meta.url).href,_e={grid:"~",class:"auto-cols-[max-content] gap-x-4 relative my4 px4 py2 shadow"},ve=u("img",{class:"self-center w14 h14 row-span-2",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1),ge={class:"text-lg col-[2]"},be={class:"text-sm c-gray"},ye=u("button",{class:"absolute bottom-2 right-16 op-30 hover:op-60"},"预览",-1),we=u("button",{class:"absolute bottom-2 right-4 op-30 hover:op-60"},"下载",-1),I=D({__name:"File",props:{name:null,desc:null},setup(e){return(o,t)=>(_(),g("div",_e,[ve,u("span",ge,T(e.name),1),u("span",be,T(e.desc),1),ye,we]))}}),xe={class:"px4 py1 bg-#0078d7 hover:bg-#005ea9 text-white b-0 leading-6","focus:outline":"~ 2 black offset-1"},$=D({__name:"Button",setup(e){return(o,t)=>{const n=H("reveal-effect");return O((_(),g("button",xe,[X(o.$slots,"default")])),[[n]])}}}),ke=D({__name:"SFC",props:{sfc:null,props:null},setup(e){const o=e;let t;const n=x();return Z(()=>{if(!o.sfc)return t==null||t.unmount(),t=null;const s=z(async()=>(await k(()=>import("./vue3-sfc-loader-6999a21f.js").then(r=>r.v),["./vue3-sfc-loader-6999a21f.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).loadModule("App.vue",{moduleCache:{vue:fe},getFile:()=>o.sfc,addStyle(r){n.value.append(Object.assign(document.createElement("style"),{textContent:r}))}}));t==null||t.unmount(),t=J(()=>Q(s,o.props)),t.mount(n.value)}),(s,r)=>(_(),g("div",{ref_key:"el",ref:n},null,512))}});async function B(e){const o=(await k(()=>import("./gogocode-235ac559.js").then(n=>n.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default;let t;return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(n,s)=>`{{ ${o(s).find("$_$name").each(f=>!Y(t=f.match.name[0].value)&&f.replaceBy(`data.${t}`)).root().generate({isPretty:!1}).replace(/;$/,"")} }}`)}function F(){let e,o;const t=new Promise((n,s)=>(e=n,o=s));return t.resolve=e,t.reject=o,t}async function Ee(e){const o=Array.from(e||[]).map(t=>t.webkitGetAsEntry()).filter(t=>t!=null).flat();return await G(o)}async function G(e,o=[]){for(const t of e)if(t.isDirectory){const n=t.createReader(),s=F();n.readEntries(r=>G(r,o).then(s.resolve)),await s}else{const n=F();t.file(s=>{const r=t.fullPath.substring(1),f=Object.defineProperty(s,"webkitRelativePath",{value:r});o.push(f),n.resolve(1)}),await n}return o}async function Re(e){const o=document.createElement("div");await pe.renderAsync(e,o,void 0,{inWrapper:!1});for(const t of o.querySelectorAll("*"))for(let n=t.firstChild;n=n==null?void 0:n.nextSibling;)Ae(n,n.previousSibling)&&(n.textContent=n.previousSibling.textContent+n.textContent,n.previousSibling.remove());return o.innerHTML}const K=e=>e.nodeType==3,U=e=>(e==null?void 0:e.tagName)==="SPAN"&&e.childNodes.length==1&&K(e.firstChild),Se=(e,o)=>(e==null?void 0:e.attributes.length)==(o==null?void 0:o.attributes.length)&&(e==null?void 0:e.getAttributeNames().every(t=>(e==null?void 0:e.getAttribute(t))==(o==null?void 0:o.getAttribute(t)))),Ae=(e,o)=>U(e)&&U(o)&&Se(e,o);async function Ce(e){const o=d=>{var i;return(i=d.match(/\{\{\s*(.*?)\s*\}\}/))==null?void 0:i[1]},t=d=>d.trim().startsWith("{{")&&d.trim().endsWith("}}"),n=new Set,s=Ne(e.body,"div");for(const d of s.querySelectorAll("*"))for(const i of d.childNodes){if(!K(i))continue;const a=i.textContent.replace(`
`,""),l=i.parentElement,c=i.nextSibling,b=o(a);if(!b)continue;i.textContent=await B(a);const y=ee(b)?b:null;if(y)if(n.add(y),t(a))if(l.childNodes.length==1)j(l,y);else{const S=e.createElement("span");j(S,y),S.append(i),l.insertBefore(i,c)}else{i.parentNode.removeChild(i);const S=a.match(/(.*?)({{.*?}})(.*)/);l.insertBefore(e.createTextNode(S[1]),c),l.insertBefore(j(e.createElement("span"),y,await B(S[2])),c),l.insertBefore(e.createTextNode(S[3]),c)}}const r=`<template>${s.outerHTML}</template>`,f=`
<script>
export default {
  props: {
    // 哪些字段可以双向绑定，默认全部
    vmodels: Array,
    // known data ${JSON.stringify([...n].reduce((d,i)=>(d[i]="",d),{}))}
    data: { type: Object, default: () => ({}) }
  },
  computed: {
    edit() {
      const set = new Set(this.vmodels)
      return (prop) => !this.vmodels || set.has(prop)
    }
  },
  methods: {
    onInput({ target }) {
      const prop = target.getAttribute('name')
      if (this.$set) this.$set(this.data, prop, target.textContent)
      else this.data[prop] = target.textContent
    }
  }
}
<\/script>
`,p=e.querySelectorAll("style"),h=Array.from(p).map(d=>d.textContent).join(`
`),m=Object.assign(e.createElement("style"),{textContent:h});m.setAttribute("scoped",""),m.textContent+=`
  [contenteditable] { display: inline-block; min-width: 2em; background: #7a7a7a12; text-align: center; }
  [contenteditable=false] { cursor: not-allowed; }
  [contenteditable]:hover { background: #7a7a7a33; }
  `;const C=m==null?void 0:m.outerHTML.replace(/<!--/g,"").replace(/-- ?>/g,""),E=(await k(()=>import("./prettierFormat-3a3234c1.js"),["./prettierFormat-3a3234c1.js","./prettier-e74c6c92.js"],import.meta.url)).default;return E([r,f,C].map(d=>d.trim()).join(`

`).trim())}function Ne(e,o){var n,s;const t=document.createElement(o);return e.getAttributeNames().forEach(r=>t.setAttribute(r,e.getAttribute(r))),t.innerHTML=e.innerHTML,(n=e.parentNode)==null||n.insertBefore(t,e),(s=e.parentNode)==null||s.removeChild(e),t}function j(e,o,t){return o&&(e.id=o,e.setAttribute(":contenteditable",`edit('${o}')`),e.setAttribute("name",o),e.setAttribute("v-on:input","onInput")),t&&(e.textContent=t),e}const v=e=>(le("data-v-abd3b856"),e=e(),ce(),e),Oe={sticky:"",aic:"",spacex4:"",px4:"","top-0":"","w-full":"",h14:"","box-border":"","bg-white":"","shadow-lg":"","z-9":""},Le=v(()=>u("h1",null,"🔨 Docx To Vue",-1)),Pe=v(()=>u("img",{w12:"",h12:"",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1)),We=v(()=>u("div",{"flex-1":""},null,-1)),$e=v(()=>u("a",{href:"https://github.com/huodoushigemi/doc2vue",target:"_blank"},[u("img",{w10:"",src:me})],-1)),Te={wrap:"","justify-evenly":""},De={key:0,absolute:"","inset-0":"",col:"",fcc:"",op60:""},Ie=v(()=>u("img",{w20:"",mb4:"",src:"https://huodoushigemi.github.io/vue-reveal-effect/assets/Microsoft-Word.80420470.svg"},null,-1)),je={key:1,absolute:"","inset-0":"",fcc:"","text-100":"","c-white":"",class:"bg-#0000002f",style:{"backdrop-filter":"blur(24px)"}},Me={w80:""},Ve=["onClick"],Be=v(()=>u("img",{w8:"",py2:"",mr4:"",src:he},null,-1)),Fe=["onClick"],Ue=v(()=>u("h2",null,"下载",-1)),He=v(()=>u("div",{mt1:"","text-xs":"","c-gray":""},"Windows 64 位",-1)),ze=v(()=>u("h2",null,"示例",-1)),Je=v(()=>u("p",null,[u("a",{"c-inherit":"",href:"https://github.com/huodoushigemi/doc2vue",target:"_blank"},"Please give a ⭐️ if this project helped you!")],-1)),qe=D({__name:"App",setup(e){const o=z(async()=>{const i=(await k(()=>import("./monaco-editor-7fb5109a.js").then(l=>l.j),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default,a=(await k(()=>import("./monaco-editor-7fb5109a.js").then(l=>l.a),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default;return window.MonacoEnvironment={getWorker(l,c){return c==="json"?new i:new a}},k(()=>import("./monaco-editor-vue3-6392893e.js"),["./monaco-editor-vue3-6392893e.js","./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)}),t=new Date(1676359501992).toLocaleString(),n=x(),{isOverDropZone:s}=ue(n,()=>{}),r=x([]),f=x(),p=de(x(),{sfc:"",props:{}});te(()=>{n.value.addEventListener("drop",async i=>{var c;const l=(await Ee((c=i.dataTransfer)==null?void 0:c.items)).filter(b=>b.name.endsWith(".docx"));if(!l.length)return alert("仅支持 docx 类型的文件");r.value=l,m(r.value[0])})});const h=oe({get:()=>JSON.stringify(p.value.props,null,2),set:i=>p.value.props=JSON.parse(i)});async function m(i){const a=await E(i);C(a),f.value=i}function C(i){var c;const a=(c=i.match(/\/\/ known data (.*)/))==null?void 0:c[1],l={vmodels:null,data:{}};a&&(l.data=JSON.parse(a)),p.value={sfc:i,props:l}}async function E(i){const a=await Re(i).catch(c=>(alert("文件内容读取失败"),Promise.reject(c))),l=new DOMParser().parseFromString(a,"text/html");return await Ce(l)}async function R(i){const a=await E(i),l=i.name.replace(".docx",".vue");let c=document.createElement("a");c.download=l,c.href=URL.createObjectURL(new Blob([a])),c.click()}async function d(){for(const i of r.value)await R(i)}return(i,a)=>{const l=H("reveal-effect");return _(),g(V,null,[u("header",Oe,[Le,Pe,We,$e,w($,null,{default:L(()=>[A("下载")]),_:1})]),u("main",Te,[u("article",{ref_key:"dropRef",ref:n,relative:"",my4:"","min-w595pt":"","min-h-842pt":"","bg-white":"","z-1":"",style:{"box-shadow":"0px 5px 30px -10px #0000004f"}},[w(ke,ne(N(p),{w595pt:""}),null,16),f.value?P("",!0):(_(),g("div",De,[Ie,A("将 docx 文件或文件夹拖拽至此")])),N(s)?(_(),g("div",je,"+")):P("",!0)],512),u("div",Me,[w(N(o),{"animate-fade-in":"",value:N(h),"onUpdate:value":a[0]||(a[0]=c=>se(h)?h.value=c:null),language:"json",height:300,options:{minimap:{enabled:!1},lineNumbers:"off"},class:"shadow",my4:""},null,8,["value"]),r.value.length?(_(),M($,{key:0,mt4:"",mb2:"",onClick:d},{default:L(()=>[A("下载全部")]),_:1})):P("",!0),r.value.length?(_(),M($,{key:1,ml2:"",mt4:"",mb2:"",onClick:a[1]||(a[1]=c=>{r.value=[],p.value=null,f.value=null})},{default:L(()=>[A("X")]),_:1})):P("",!0),(_(!0),g(V,null,re(r.value,(c,b)=>O((_(),g("div",{key:b,class:ie(["aic px4 mb1 leading-8 bg-#80808033 hover:bg-#0078d72f cursor-pointer",c==f.value&&"bg-#0078d72f!"]),onClick:y=>m(c)},[Be,A(" "+T(c.webkitRelativePath.replace(".docx",".vue"))+" ",1),u("button",{mla:"","op-30":"","hover:op-60":"",onClick:ae(y=>R(c),["stop"])},"下载",8,Fe)],10,Ve)),[[l]])),128))]),a[2]||(W(-1),a[2]=u("article",{"min-w75":"",px4:""},[Ue,w($,null,{default:L(()=>[A("下载 doc2vue.exe")]),_:1}),He,ze,O(w(I,{name:"exmaple.doc",desc:"示例文件"},null,512),[[l]]),O(w(I,{name:"exmaple-img.doc",desc:"带图片的示例"},null,512),[[l]]),O(w(I,{name:"exmaple-more.doc",desc:"更多的示例"},null,512),[[l]])]),W(1),a[2])]),a[3]||(W(-1),a[3]=u("footer",{col:"",fcc:"",mt8:"",h40:"","bg-gray-300":""},[u("p",null,[u("b",null,"Last updated: "+T(N(t)),1)]),Je]),W(1),a[3])],64)}}});const Ge=(e,o)=>{const t=e.__vccOpts||e;for(const[n,s]of o)t[n]=s;return t},Ke=Ge(qe,[["__scopeId","data-v-abd3b856"]]);function Xe(e={}){const{immediate:o=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:s,onRegisteredSW:r,onRegisterError:f}=e;let p,h,m;const C=async(R=!0)=>{await h,await(m==null?void 0:m())};async function E(){if("serviceWorker"in navigator){const{Workbox:R}=await k(()=>import("./workbox-window-295a6886.js"),[],import.meta.url);p=new R("./sw.js",{scope:"./",type:"classic"}),m=async()=>{await(p==null?void 0:p.messageSkipWaiting())};{let d=!1;const i=()=>{d=!0,p==null||p.addEventListener("controlling",a=>{a.isUpdate&&window.location.reload()}),t==null||t()};p.addEventListener("installed",a=>{typeof a.isUpdate>"u"?typeof a.isExternal<"u"?a.isExternal?i():!d&&(n==null||n()):a.isExternal?window.location.reload():!d&&(n==null||n()):a.isUpdate||n==null||n()}),p.addEventListener("waiting",i),p.addEventListener("externalwaiting",i)}p.register({immediate:o}).then(d=>{r?r("./sw.js",d):s==null||s(d)}).catch(d=>{f==null||f(d)})}}return h=E(),C}function Ze(e={}){const{immediate:o=!0,onNeedRefresh:t,onOfflineReady:n,onRegistered:s,onRegisteredSW:r,onRegisterError:f}=e,p=x(!1),h=x(!1);return{updateServiceWorker:Xe({immediate:o,onNeedRefresh(){p.value=!0,t==null||t()},onOfflineReady(){h.value=!0,n==null||n()},onRegistered:s,onRegisteredSW:r,onRegisterError:f}),offlineReady:h,needRefresh:p}}Ze({onRegisteredSW(){console.log("onRegisteredSW")},onNeedRefresh(){console.log("onNeedRefresh"),confirm("网页内容已过时，是否刷新页面")&&location.reload()},onRegisterError(e){console.error("onRegisterError",e)},onOfflineReady(){console.log("onOfflineReady")}});q.setDefaultProps({borderWidth:2,borderColor:"#0000002f"});J(Ke).use(q).mount("#app");
