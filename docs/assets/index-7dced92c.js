import{U as D,A as v,D as d,aX as N,ay as f,bm as L,aI as Y,aK as J,r as P,e as ee,Q as z,x as X,a4 as te,bs as oe,o as ne,c as re,u as _,y as j,bk as I,z as C,O as R,aj as se,N as S,i as ae,F as W,aH as ie,ak as le,bp as ce,aO as O}from"./@vue-89cc5008.js";import{R as G}from"./vue-reveal-effect-da713a81.js";import{_ as k}from"./monaco-editor-7fb5109a.js";import{f as ue,r as de}from"./@vueuse-c20e6293.js";import{v as pe}from"./vue-9c2f0be1.js";import{d as me}from"./docx-preview-32015948.js";import"./@ctrl-43a4208a.js";import"./jszip-1c3a6353.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();const fe=""+new URL("1-28672ded.docx",import.meta.url).href,he=""+new URL("2-70d82b5f.docx",import.meta.url).href,_e=""+new URL("3-cc554d79.docx",import.meta.url).href,V=""+new URL("word-a6e5b8a9.svg",import.meta.url).href,ge=""+new URL("github-540f5a2f.svg",import.meta.url).href,ve=""+new URL("vue-5532db34.svg",import.meta.url).href,be=""+new URL("round_down-b71e62d1.svg",import.meta.url).href,we={grid:"~ auto-cols-[max-content]","gap-x-4":"",relative:"",my4:"",px5:"",py3:"",shadow:"","bg-white":"",class:""},ye=d("img",{"self-center":"",w12:"",h12:"","row-span-2":"",src:V},null,-1),xe={"text-lg":"",mb1:"",class:"col-[2]"},ke={"text-sm":"","c-gray":""},M=D({__name:"File",props:{name:null,desc:null,url:null},emits:["preview"],setup(e,{emit:o}){const t=e;async function n(){const i=await(await window.fetch(t.url)).blob();return new File([i],t.name,{type:i.type})}async function r(){o("preview",await n())}async function s(){const i=document.createElement("a");i.href=URL.createObjectURL(await n()),i.download=t.name,i.click(),URL.revokeObjectURL(i.href)}return(i,b)=>(f(),v("div",we,[ye,d("span",xe,N(e.name),1),d("span",ke,N(e.desc),1),d("button",{absolute:"","bottom-2":"","right-16":"","op-30":"","hover:op-60":"",onClick:r},"预览"),d("button",{absolute:"","bottom-2":"","right-4":"","op-30":"","hover:op-60":"",onClick:s},"下载")]))}}),Ee={class:"px4 py1 bg-#0078d7 hover:bg-#005ea9 text-white b-0 leading-6","focus:outline":"~ 2 black offset-1"},U=D({__name:"Button",setup(e){return(o,t)=>{const n=J("reveal-effect");return L((f(),v("button",Ee,[Y(o.$slots,"default")])),[[n]])}}}),Le=D({__name:"SFC",props:{sfc:null,props:null},setup(e){const o=e;let t;const n=P();return ee(()=>{if(!o.sfc)return t==null||t.unmount(),t=null;const r=z(async()=>(await k(()=>import("./vue3-sfc-loader-6999a21f.js").then(s=>s.v),["./vue3-sfc-loader-6999a21f.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).loadModule("App.vue",{moduleCache:{vue:pe},getFile:()=>o.sfc,addStyle(s){n.value.append(Object.assign(document.createElement("style"),{textContent:s}))}}));t==null||t.unmount(),t=X(()=>te(r,o.props)),t.mount(n.value)}),(r,s)=>(f(),v("div",{ref_key:"el",ref:n},null,512))}});let $;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),$=e,console.log("👍","beforeinstallprompt",e),F.value=!1});const F=P(!0);window.addEventListener("appinstalled",()=>F.value=!0);function Pe(){return{prompt:async()=>await($==null?void 0:$.prompt()),installed:F}}async function H(e){const o=(await k(()=>import("./gogocode-235ac559.js").then(t=>t.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default;return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(t,n)=>`{{ ${o(n).find("$_$").each(s=>{const i=s.parent(0),b=Ae(s).name;b&&oe(b)||(i.node.type=="MemberExpression"&&s.parent(1).node.type!="MemberExpression"?(i.replaceBy(`get('${i.generate()}')`),i.replaceBy(i.node.expression)):i.node.type!="MemberExpression"&&(s.node.name=`get('${s.node.name}')`))}).root().generate({isPretty:!1})} }}`)}function Ae(e){const o=e.parent(0);return o.node.type==="MemberExpression"?o.find("$_$")[0].nodePath.node:e.node}async function Ce(e){const o=(await k(()=>import("./gogocode-235ac559.js").then(n=>n.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default,t=o(e).attr("program");if(t.body.length==1&&t.body[0].type==="ExpressionStatement")return["Identifier","MemberExpression"].includes(t.body[0].expression.type)}function q(){let e,o;const t=new Promise((n,r)=>(e=n,o=r));return t.resolve=e,t.reject=o,t}async function Re(e){const o=Array.from(e||[]).map(t=>t.webkitGetAsEntry()).filter(t=>t!=null).flat();return await K(o)}async function K(e,o=[]){for(const t of e)if(t.isDirectory){const n=t.createReader(),r=q();n.readEntries(s=>K(s,o).then(r.resolve)),await r}else{const n=q();t.file(r=>{const s=t.fullPath.substring(1),i=Object.defineProperty(r,"webkitRelativePath",{value:s});o.push(i),n.resolve(1)}),await n}return o}function Se(e,o=""){const t=Oe(e);for(;e=t.pop();)(n=>(o=typeof e=="number"?[]:{})[e]=n)(o);return o}function Oe(e){return e.replace(/\\[(.+?)\\]/,".$1").split(".")}async function $e(e){const o=document.createElement("div");await me.renderAsync(e,o,void 0,{inWrapper:!1,useBase64URL:!0});for(const t of o.querySelectorAll("*"))for(let n=t.firstChild;n=n==null?void 0:n.nextSibling;)Te(n,n.previousSibling)&&(n.textContent=n.previousSibling.textContent+n.textContent,n.previousSibling.remove());return await Promise.all([...o.querySelectorAll("img")].map(t=>new Promise(n=>(t.onload=n,t.onerror=n)))),o.innerHTML}const Z=e=>e.nodeType==3,Ne=e=>(e==null?void 0:e.tagName)==="SPAN"&&e.childNodes.length==1&&Z(e.firstChild),De=(e,o)=>(e==null?void 0:e.attributes.length)==(o==null?void 0:o.attributes.length)&&(e==null?void 0:e.getAttributeNames().every(t=>(e==null?void 0:e.getAttribute(t))==(o==null?void 0:o.getAttribute(t)))),Te=(e,o)=>[e,o].every(Ne)&&De(e,o);async function je(e){const o=m=>{var p;return(p=m.match(/\{\{\s*(.*?)\s*\}\}/))==null?void 0:p[1]},t=m=>m.trim().startsWith("{{")&&m.trim().endsWith("}}"),n=new Set,r=Ie(e.body,"div");for(const m of r.querySelectorAll("*"))for(const p of m.childNodes){if(!Z(p))continue;const x=p.textContent.replace(`
`,""),w=p.parentElement,l=p.nextSibling,c=o(x);if(!c)continue;p.textContent=await H(x);const u=await Ce(c)?c:null;if(u)if(n.add(u),t(x))if(w.childNodes.length==1)B(w,u);else{const a=e.createElement("span");B(a,u),a.append(p),w.insertBefore(p,l)}else{p.parentNode.removeChild(p);const a=x.match(/(.*?)({{.*?}})(.*)/);w.insertBefore(e.createTextNode(a[1]),l),w.insertBefore(B(e.createElement("span"),u,await H(a[2])),l),w.insertBefore(e.createTextNode(a[3]),l)}}const s=`<template>${r.outerHTML}</template>`,i=`
<script>
export default {
  props: {
    // 哪些字段可以双向绑定，默认全部
    vmodels: Array,
    // known data ${JSON.stringify([...n].reduce((m,p)=>Object.assign(m,Se(p)),{}))}
    data: { type: Object, default: () => ({}) }
  },
  computed: {
    edit() {
      const set = new Set(this.vmodels)
      return (prop) => !this.vmodels || set.has(prop)
    }
  },
  methods: {
    onInput({ target }) {
      const prop = target.getAttribute('name')
      this.set(prop, target.textContent)
    },
    getPaths(k) {
      return k.replace(/\\[(.+?)\\]/, '.$1').split('.')
    },
    get(k) {
      return this.getPaths(k).reduce((o, k) => o?.[k], this.data)
    },
    set(k, v) {
      const ks = this.getPaths(k)
      const prop = ks.shift()
      while (k = ks.pop()) (vv => (v = typeof k === 'number' ? [] : {})[k] = vv)(v)
      this._set(prop, v)
    },
    _set(prop, val) {
      if (this.$set) this.$set(this.data, prop, val)
      else this.data[prop] = val
    }
  }
}
<\/script>
`,b=e.querySelectorAll("style"),g=Array.from(b).map(m=>m.textContent).join(`
`),h=Object.assign(e.createElement("style"),{textContent:g});h.setAttribute("scoped",""),h.textContent+=`
  [contenteditable] { display: inline-block; min-width: 2em; background: #7a7a7a12; text-align: center; }
  [contenteditable=false] { cursor: not-allowed; }
  [contenteditable]:hover { background: #7a7a7a33; }
  `;const y=h==null?void 0:h.outerHTML.replace(/<!--/g,"").replace(/-- ?>/g,""),A=(await k(()=>import("./prettierFormat-3a3234c1.js"),["./prettierFormat-3a3234c1.js","./prettier-e74c6c92.js"],import.meta.url)).default;return A([s,i,y].map(m=>m.trim()).join(`

`).trim())}function Ie(e,o){var n,r;const t=document.createElement(o);return e.getAttributeNames().forEach(s=>t.setAttribute(s,e.getAttribute(s))),t.innerHTML=e.innerHTML,(n=e.parentNode)==null||n.insertBefore(t,e),(r=e.parentNode)==null||r.removeChild(e),t}function B(e,o,t){return o&&(e.id=o,e.setAttribute(":contenteditable",`edit('${o}')`),e.setAttribute("name",o),e.setAttribute("v-on:input","onInput")),t&&(e.textContent=t),e}const Me={sticky:"!",aic:"",spacex4:"",px4:"","top-0":"","w-full":"",h14:"","box-border":"","bg-white":"","shadow-lg":"","z-9":""},Ue=d("h1",null,"🔨 Docx To Vue",-1),Be=d("img",{w11:"",h11:"",src:V},null,-1),Ve=d("div",{"flex-1":""},null,-1),Fe=d("a",{href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},[d("img",{src:"https://img.shields.io/github/stars/huodoushigemi/docx2vue.svg?style=for-the-badge"})],-1),We=d("a",{href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},[d("img",{w10:"",src:ge})],-1),He={wrap:"","justify-evenly":""},qe={key:0,class:"animate__flipInX",absolute:"","inset-0":"",col:"",fcc:"",op60:""},Je=d("img",{w20:"",mb4:"",src:V},null,-1),ze={key:1,absolute:"","inset-0":"",fcc:"","text-100":"","c-white":"",class:"bg-#0000002f",style:{"backdrop-filter":"blur(24px)"}},Xe={w80:""},Ge=["onClick"],Ke=d("img",{w8:"",py2:"",mr4:"",src:ve},null,-1),Ze=["onClick"],Qe=d("img",{h14:"","scale-75":"",op40:"",hover:"scale-85 op80",src:be,alt:"download",title:"download"},null,-1),Ye=[Qe],et=d("h2",null,"示例",-1),tt=d("p",null,[d("a",{"c-inherit":"",href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},"Please give a ⭐️ if this project helped you!")],-1),ot=D({__name:"App",setup(e){const o=z(async()=>{const l=(await k(()=>import("./monaco-editor-7fb5109a.js").then(u=>u.j),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default,c=(await k(()=>import("./monaco-editor-7fb5109a.js").then(u=>u.a),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default;return window.MonacoEnvironment={getWorker(u,a){return a==="json"?new l:new c}},k(()=>import("./monaco-editor-vue3-6392893e.js"),["./monaco-editor-vue3-6392893e.js","./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)}),t=["1","2","3"].map(l=>new URL(Object.assign({"./assets/1.docx":fe,"./assets/2.docx":he,"./assets/3.docx":_e})[`./assets/${l}.docx`],self.location).href),n=new Date(1676571098427).toLocaleString(),{prompt:r,installed:s}=Pe(),i=P(),{isOverDropZone:b}=ue(i,()=>{}),g=P([]),h=P(),y=de(P(),{sfc:"",props:{}});ne(()=>{i.value.addEventListener("drop",async l=>{var a;const u=(await Re((a=l.dataTransfer)==null?void 0:a.items)).filter(T=>T.name.endsWith(".docx"));if(!u.length)return alert("仅支持 docx 类型的文件");g.value=u,E(g.value[0])})});const A=re({get:()=>JSON.stringify(y.value.props,null,2),set:l=>y.value.props=JSON.parse(l)});async function E(l){const c=await p(l);m(c),h.value=l}function m(l){var a;const c=(a=l.match(/\/\/ known data (.*)/))==null?void 0:a[1],u={vmodels:null,data:{}};c&&(u.data=JSON.parse(c)),y.value={sfc:l,props:u}}async function p(l){const c=await $e(l).catch(a=>(alert("文件内容读取失败"),Promise.reject(a))),u=new DOMParser().parseFromString(c,"text/html");return await je(u)}async function x(l){const c=await p(l),u=l.name.replace(".docx",".vue");let a=document.createElement("a");a.download=u,a.href=URL.createObjectURL(new Blob([c])),a.click()}async function w(){for(const l of g.value)await x(l)}return(l,c)=>{const u=J("reveal-effect");return f(),v(W,null,[L((f(),v("header",Me,[Ue,Be,Ve,Fe,We,_(s)?C("",!0):(f(),j(U,{key:0,onClick:_(r)},{default:I(()=>[S("下载")]),_:1},8,["onClick"]))])),[[u]]),d("main",He,[d("article",{ref_key:"dropRef",ref:i,relative:"",my4:"","min-w595pt":"","min-h-842pt":"","bg-white":"","z-1":"",style:{"box-shadow":"0px 5px 30px -10px #0000004f"}},[R(Le,se(_(y),{w595pt:""}),null,16),h.value?C("",!0):(f(),v("div",qe,[Je,S("将 docx 文件或文件夹拖拽至此")])),_(b)?(f(),v("div",ze,"+")):C("",!0)],512),d("div",Xe,[R(_(o),{value:_(A),"onUpdate:value":c[0]||(c[0]=a=>ae(A)?A.value=a:null),"bg-gray":"",language:"json",height:300,options:{minimap:{enabled:!1},lineNumbers:"off"},shadow:"",class:"animate__animated animate__flipInX",my4:""},null,8,["value"]),g.value.length?(f(),j(U,{key:0,mt4:"",mb2:"",onClick:w},{default:I(()=>[S("下载全部")]),_:1})):C("",!0),g.value.length?(f(),j(U,{key:1,ml2:"",mt4:"",mb2:"",onClick:c[1]||(c[1]=a=>{g.value=[],y.value=null,h.value=null})},{default:I(()=>[S("X")]),_:1})):C("",!0),(f(!0),v(W,null,ie(g.value,(a,T)=>L((f(),v("div",{key:T,aic:"",pl4:"",mb1:"",h14:"","leading-8":"","cursor-pointer":"",class:le(["bg-#80808033 hover:bg-#8080804f",a==h.value&&"bg-#00162733!"]),onClick:Q=>E(a)},[Ke,S(" "+N(a.webkitRelativePath.replace(".docx",".vue"))+" ",1),d("div",{mla:"","box-border":"","leading-0":"",class:"bg-#8080801a hover:bg-#80808066",onClick:ce(Q=>x(a),["stop"])},Ye,8,Ze)],10,Ge)),[[u]])),128))]),c[2]||(O(-1),c[2]=d("article",{"min-w75":"",px4:""},[et,L(R(M,{name:"exmaple.doc",desc:"示例文件",url:_(t)[0],onPreview:E},null,8,["url"]),[[u]]),L(R(M,{name:"exmaple-img.doc",desc:"带图片的示例",url:_(t)[1],onPreview:E},null,8,["url"]),[[u]]),L(R(M,{name:"exmaple-more.doc",desc:"更多的示例",url:_(t)[2],onPreview:E},null,8,["url"]),[[u]])]),O(1),c[2])]),c[3]||(O(-1),c[3]=d("footer",{col:"",fcc:"",mt8:"",h40:"","bg-gray-300":""},[d("p",null,[d("b",null,"Last updated: "+N(_(n)),1)]),tt]),O(1),c[3])],64)}}});window.addEventListener("appinstalled",()=>console.log("appinstalled"));G.setDefaultProps({borderWidth:2,borderColor:"#0000002f"});X(ot).use(G).mount("#app");
