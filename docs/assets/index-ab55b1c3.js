import{U as T,A as k,D as d,aX as j,ay as _,bm as P,aI as ne,aK as K,r as E,e as oe,Q as Z,x as Q,a4 as re,bs as se,bt as ie,am as ae,o as le,c as ce,u as b,y as I,bk as U,z as A,O as C,aj as ue,N as O,i as de,F as q,aH as pe,ak as fe,bp as me,aO as $}from"./@vue-e6c15c36.js";import{R as Y}from"./vue-reveal-effect-94b5d062.js";import{_ as R}from"./monaco-editor-7fb5109a.js";import{f as he,r as ge}from"./@vueuse-d8de8cc9.js";import{v as ve}from"./vue-15e3ffcd.js";import{d as _e}from"./docx-preview-32015948.js";import"./@ctrl-43a4208a.js";import"./jszip-1c3a6353.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const be=""+new URL("1-02f4af48.docx",import.meta.url).href,we=""+new URL("2-d92cb5f6.docx",import.meta.url).href,ye=""+new URL("3-cc554d79.docx",import.meta.url).href,z=""+new URL("word-a6e5b8a9.svg",import.meta.url).href,xe=""+new URL("github-540f5a2f.svg",import.meta.url).href,ke=""+new URL("vue-5532db34.svg",import.meta.url).href,Ee=""+new URL("round_down-b71e62d1.svg",import.meta.url).href,Re={grid:"~ auto-cols-[max-content]","gap-x-4":"",relative:"",my4:"",px5:"",py3:"",shadow:"","bg-white":"",class:""},Le=d("img",{"self-center":"",w12:"",h12:"","row-span-2":"",src:z},null,-1),Se={"text-lg":"",mb1:"",class:"col-[2]"},Pe={"text-sm":"","c-gray":""},M=T({__name:"File",props:{name:null,desc:null,url:null},emits:["preview"],setup(e,{emit:t}){const n=e;async function o(){const i=await(await window.fetch(n.url)).blob();return new File([i],n.name,{type:i.type})}async function r(){t("preview",await o())}async function s(){const i=document.createElement("a");i.href=URL.createObjectURL(await o()),i.download=n.name,i.click(),URL.revokeObjectURL(i.href)}return(i,f)=>(_(),k("div",Re,[Le,d("span",Se,j(e.name),1),d("span",Pe,j(e.desc),1),d("button",{absolute:"","bottom-2":"","right-16":"","op-30":"","hover:op-60":"",onClick:r},"预览"),d("button",{absolute:"","bottom-2":"","right-4":"","op-30":"","hover:op-60":"",onClick:s},"下载")]))}}),Ae={class:"px4 py1 bg-#0078d7 hover:bg-#005ea9 text-white b-0 leading-6","focus:outline":"~ 2 black offset-1"},B=T({__name:"Button",setup(e){return(t,n)=>{const o=K("reveal-effect");return P((_(),k("button",Ae,[ne(t.$slots,"default")])),[[o]])}}}),Ce=T({__name:"SFC",props:{sfc:null,props:null},setup(e){const t=e;let n;const o=E();return oe(()=>{if(!t.sfc)return n==null||n.unmount(),n=null;const r=Z(async()=>(await R(()=>import("./vue3-sfc-loader-6999a21f.js").then(s=>s.v),["./vue3-sfc-loader-6999a21f.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).loadModule("App.vue",{moduleCache:{vue:ve},getFile:()=>t.sfc,addStyle(s){o.value.append(Object.assign(document.createElement("style"),{textContent:s}))}}));n==null||n.unmount(),n=Q(()=>re(r,t.props)),n.mount(o.value)}),(r,s)=>(_(),k("div",{ref_key:"el",ref:o},null,512))}});let D;window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),D=e,console.log("👍","beforeinstallprompt",e),H.value=!1});const H=E(!0);window.addEventListener("appinstalled",()=>H.value=!0);function Oe(){return{prompt:async()=>await(D==null?void 0:D.prompt()),installed:H}}async function J(e){const t=(await R(()=>import("./gogocode-235ac559.js").then(n=>n.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default;return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(n,o)=>`{{ ${t(o).find("$_$").each(s=>{const i=s.parent(0),f=Ne(s).name;f&&se(f)||(i.node.type=="MemberExpression"&&s.parent(1).node.type!="MemberExpression"?(i.replaceBy(`get('${i.generate()}')`),i.replaceBy(i.node.expression)):i.node.type!="MemberExpression"&&(s.node.name=`get('${s.node.name}')`))}).root().generate({isPretty:!1})} }}`)}function Ne(e){const t=e.parent(0);return t.node.type==="MemberExpression"?t.find("$_$")[0].nodePath.node:e.node}async function $e(e){const t=(await R(()=>import("./gogocode-235ac559.js").then(o=>o.g),["./gogocode-235ac559.js","./docx-preview-32015948.js","./jszip-1c3a6353.js"],import.meta.url)).default,n=t(e).attr("program");if(n.body.length==1&&n.body[0].type==="ExpressionStatement")return["Identifier","MemberExpression"].includes(n.body[0].expression.type)}function X(){let e,t;const n=new Promise((o,r)=>(e=o,t=r));return n.resolve=e,n.reject=t,n}async function De(e){const t=Array.from(e||[]).map(n=>n.webkitGetAsEntry()).filter(n=>n!=null).flat();return await ee(t)}async function ee(e,t=[]){for(const n of e)if(n.isDirectory){const o=n.createReader(),r=X();o.readEntries(s=>ee(s,t).then(r.resolve)),await r}else{const o=X();n.file(r=>{const s=n.fullPath.substring(1),i=Object.defineProperty(r,"webkitRelativePath",{value:s});t.push(i),o.resolve(1)}),await o}return t}function je(e,t=""){const n=Te(e);for(;e=n.pop();)(o=>(t=typeof e=="number"?[]:{})[e]=o)(t);return t}function Te(e){return e.replace(/\\[(.+?)\\]/,".$1").split(".")}async function We(e){const t=document.createElement("div");await _e.renderAsync(e,t,void 0,{inWrapper:!1,useBase64URL:!0});for(const n of t.querySelectorAll("*"))for(let o=n.firstChild;o=o==null?void 0:o.nextSibling;)Me(o,o.previousSibling)&&(o.textContent=o.previousSibling.textContent+o.textContent,o.previousSibling.remove());return await Promise.all([...t.querySelectorAll("img")].map(n=>new Promise(o=>(n.onload=o,n.onerror=o)))),t.innerHTML}const te=e=>e.nodeType==3,Ie=e=>(e==null?void 0:e.tagName)==="SPAN"&&e.childNodes.length==1&&te(e.firstChild),Ue=(e,t)=>(e==null?void 0:e.attributes.length)==(t==null?void 0:t.attributes.length)&&(e==null?void 0:e.getAttributeNames().every(n=>(e==null?void 0:e.getAttribute(n))==(t==null?void 0:t.getAttribute(n)))),Me=(e,t)=>[e,t].every(Ie)&&Ue(e,t);async function Be(e){const t=p=>{var m;return(m=p.match(/\{\{\s*(.*?)\s*\}\}/))==null?void 0:m[1]},n=p=>p.trim().startsWith("{{")&&p.trim().endsWith("}}"),o=new Set,r=Ve(e.body,"div");for(const p of r.querySelectorAll("*"))for(const m of p.childNodes){if(!te(m))continue;const v=m.textContent.replace(`
`,""),x=m.parentElement,a=m.nextSibling,l=t(v);if(!l)continue;m.textContent=await J(v);const c=await $e(l)?l:null;if(c)if(o.add(c),n(v))if(x.childNodes.length==1)V(x,c);else{const u=e.createElement("span");V(u,c),u.append(m),x.insertBefore(m,a)}else{m.parentNode.removeChild(m);const u=v.match(/(.*?)({{.*?}})(.*)/),[,S,W,N]=u;S&&x.insertBefore(F(G("span",null,S)),a),x.insertBefore(V(e.createElement("span"),c,await J(W)),a),t(N)?x.insertBefore(e.createTextNode(N),a):N&&x.insertBefore(F(G("span",null,N)),a)}}const s=`<template>${r.outerHTML}</template>`,i=`
<script>
export default {
  props: {
    // 哪些字段可以双向绑定，默认全部
    vmodels: Array,
    // known data ${JSON.stringify([...o].reduce((p,m)=>Object.assign(p,je(m)),{}))}
    data: { type: Object, default: () => ({}) }
  },
  computed: {
    edit() {
      const set = new Set(this.vmodels)
      return (prop) => !this.vmodels || set.has(prop)
    }
  },
  methods: {
    onInput({ target }) {
      const prop = target.getAttribute('name')
      this.set(prop, target.textContent)
    },
    getPaths(k) {
      return k.replace(/\\[(.+?)\\]/, '.$1').split('.')
    },
    get(k) {
      return this.getPaths(k).reduce((o, k) => o?.[k], this.data)
    },
    set(k, v) {
      const ks = this.getPaths(k)
      const prop = ks.shift()
      while (k = ks.pop()) (vv => (v = typeof k === 'number' ? [] : {})[k] = vv)(v)
      this._set(prop, v)
    },
    _set(prop, val) {
      if (this.$set) this.$set(this.data, prop, val)
      else this.data[prop] = val
    }
  }
}
<\/script>
`,f=e.querySelectorAll("style"),h=Array.from(f).map(p=>p.textContent).join(`
`),g=Object.assign(e.createElement("style"),{textContent:h});g.setAttribute("scoped",""),g.textContent+=`
  [contenteditable] { background: #7a7a7a12; text-align: center; white-space: break-spaces !important; }
  [contenteditable=false] { cursor: not-allowed; }
  [contenteditable]:empty { padding-left: 1em; padding-right: 1em; }
  [contenteditable]:empty::after { content: '' }
  [contenteditable]:hover { background: #7a7a7a33; }
  `;const w=g==null?void 0:g.outerHTML.replace(/<!--/g,"").replace(/-- ?>/g,""),L=(await R(()=>import("./prettierFormat-3a3234c1.js"),["./prettierFormat-3a3234c1.js","./prettier-e74c6c92.js"],import.meta.url)).default;return L([s,i,w].map(p=>p.trim()).join(`

`).trim())}function Ve(e,t){var o,r;const n=document.createElement(t);return e.getAttributeNames().forEach(s=>n.setAttribute(s,e.getAttribute(s))),n.innerHTML=e.innerHTML,(o=e.parentNode)==null||o.insertBefore(n,e),(r=e.parentNode)==null||r.removeChild(e),n}function V(e,t,n){return t&&(Fe(e,t),F(e)),n&&(e.textContent=n),e}function F(e){const t={fontFamily:"inherit",minHeight:"inherit",fontSize:"inherit"};return e.setAttribute("style",ie(ae([t,e.getAttribute("style")]))),e}function Fe(e,t){return e.id=t,e.setAttribute(":contenteditable",`edit('${t}')`),e.setAttribute("name",t),e.setAttribute("v-on:input","onInput"),e}function G(e,t,n){const o=document.createElement(e);return Object.keys(t??{}).forEach(r=>o.setAttribute(r,t[r])),o.textContent=n,o}const ze={sticky:"!",aic:"",spacex4:"",px4:"","top-0":"","w-full":"",h14:"","box-border":"","bg-white":"","shadow-lg":"","z-9":""},He=d("h1",null,"🔨 Docx To Vue",-1),qe=d("img",{w11:"",h11:"",src:z},null,-1),Je=d("div",{"flex-1":""},null,-1),Xe=d("a",{href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},[d("img",{src:"https://img.shields.io/github/stars/huodoushigemi/docx2vue.svg?style=for-the-badge"})],-1),Ge=d("a",{href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},[d("img",{w10:"",src:xe})],-1),Ke={wrap:"","justify-evenly":""},Ze={key:0,class:"animate__flipInX",absolute:"","inset-0":"",col:"",fcc:"",op60:""},Qe=d("img",{w20:"",mb4:"",src:z},null,-1),Ye={key:1,absolute:"","inset-0":"",fcc:"","text-100":"","c-white":"",class:"bg-#0000002f",style:{"backdrop-filter":"blur(24px)"}},et={w80:""},tt=["onClick"],nt=d("img",{w8:"",py2:"",mr4:"",src:ke},null,-1),ot=["onClick"],rt=d("img",{h14:"","scale-75":"",op40:"",hover:"scale-85 op80",src:Ee,alt:"download",title:"download"},null,-1),st=[rt],it=d("h2",null,"示例",-1),at=d("p",null,[d("a",{"c-inherit":"",href:"https://github.com/huodoushigemi/docx2vue",target:"_blank"},"Please give a ⭐️ if this project helped you!")],-1),lt=T({__name:"App",setup(e){const t=Z(async()=>{const a=(await R(()=>import("./monaco-editor-7fb5109a.js").then(c=>c.j),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default,l=(await R(()=>import("./monaco-editor-7fb5109a.js").then(c=>c.a),["./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)).default;return window.MonacoEnvironment={getWorker(c,u){return u==="json"?new a:new l}},R(()=>import("./monaco-editor-vue3-6392893e.js"),["./monaco-editor-vue3-6392893e.js","./monaco-editor-7fb5109a.js","./monaco-editor-4b982060.css"],import.meta.url)}),n=["1","2","3"].map(a=>new URL(Object.assign({"./assets/1.docx":be,"./assets/2.docx":we,"./assets/3.docx":ye})[`./assets/${a}.docx`],self.location).href),o=new Date(1676667331512).toLocaleString(),{prompt:r,installed:s}=Oe(),i=E(),{isOverDropZone:f}=he(i,()=>{}),h=E([]),g=E(),w=ge(E(),{sfc:"",props:{}});le(()=>{i.value.addEventListener("drop",async a=>{var u;const c=(await De((u=a.dataTransfer)==null?void 0:u.items)).filter(S=>S.name.endsWith(".docx"));if(!c.length)return alert("仅支持 docx 类型的文件");h.value=c,y(h.value[0])})});const L=ce({get:()=>JSON.stringify(w.value.props,null,2),set:a=>w.value.props=JSON.parse(a)});async function y(a){const l=await m(a);p(l),g.value=a}function p(a){var u;const l=(u=a.match(/\/\/ known data (.*)/))==null?void 0:u[1],c={vmodels:null,data:{}};l&&(c.data=JSON.parse(l)),w.value={sfc:a,props:c}}async function m(a){const l=await We(a).catch(u=>(alert("文件内容读取失败"),Promise.reject(u))),c=new DOMParser().parseFromString(l,"text/html");return await Be(c)}async function v(a){const l=await m(a),c=a.name.replace(".docx",".vue");let u=document.createElement("a");u.download=c,u.href=URL.createObjectURL(new Blob([l])),u.click()}async function x(){for(const a of h.value)await v(a)}return(a,l)=>{const c=K("reveal-effect");return _(),k(q,null,[P((_(),k("header",ze,[He,qe,Je,Xe,Ge,b(s)?A("",!0):(_(),I(B,{key:0,onClick:b(r)},{default:U(()=>[O("下载")]),_:1},8,["onClick"]))])),[[c]]),d("main",Ke,[d("article",{ref_key:"dropRef",ref:i,relative:"",my4:"","min-h-842pt":"","bg-white":"","z-1":"",style:{"box-shadow":"0px 5px 30px -10px #0000004f"}},[C(Ce,ue(b(w),{"min-w595pt":""}),null,16),g.value?A("",!0):(_(),k("div",Ze,[Qe,O("将 docx 文件或文件夹拖拽至此")])),b(f)?(_(),k("div",Ye,"+")):A("",!0)],512),d("div",et,[C(b(t),{value:b(L),"onUpdate:value":l[0]||(l[0]=u=>de(L)?L.value=u:null),"bg-gray":"",language:"json",height:300,options:{minimap:{enabled:!1},lineNumbers:"off"},shadow:"",class:"animate__animated animate__flipInX",my4:""},null,8,["value"]),h.value.length?(_(),I(B,{key:0,mt4:"",mb2:"",onClick:x},{default:U(()=>[O("下载全部")]),_:1})):A("",!0),h.value.length?(_(),I(B,{key:1,ml2:"",mt4:"",mb2:"",onClick:l[1]||(l[1]=u=>{h.value=[],w.value=null,g.value=null})},{default:U(()=>[O("X")]),_:1})):A("",!0),(_(!0),k(q,null,pe(h.value,(u,S)=>P((_(),k("div",{key:S,aic:"",pl4:"",mb1:"",h14:"","leading-8":"","cursor-pointer":"",class:fe(["bg-#80808033 hover:bg-#8080804f",u==g.value&&"bg-#00162733!"]),onClick:W=>y(u)},[nt,O(" "+j(u.webkitRelativePath.replace(".docx",".vue"))+" ",1),d("div",{mla:"","box-border":"","leading-0":"",class:"bg-#8080801a hover:bg-#80808066",onClick:me(W=>v(u),["stop"])},st,8,ot)],10,tt)),[[c]])),128))]),l[2]||($(-1),l[2]=d("article",{"min-w75":"",px4:""},[it,P(C(M,{name:"exmaple.doc",desc:"示例文件",url:b(n)[0],onPreview:y},null,8,["url"]),[[c]]),P(C(M,{name:"exmaple-img.doc",desc:"带图片的示例",url:b(n)[1],onPreview:y},null,8,["url"]),[[c]]),P(C(M,{name:"exmaple-more.doc",desc:"更多的示例",url:b(n)[2],onPreview:y},null,8,["url"]),[[c]])]),$(1),l[2])]),l[3]||($(-1),l[3]=d("footer",{col:"",fcc:"",mt8:"",h40:"","bg-gray-300":""},[d("p",null,[d("b",null,"Last updated: "+j(b(o)),1)]),at]),$(1),l[3])],64)}}});function ct(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:r,onRegisteredSW:s,onRegisterError:i}=e;let f,h,g;const w=async(y=!0)=>{await h,await(g==null?void 0:g())};async function L(){if("serviceWorker"in navigator){const{Workbox:y}=await R(()=>import("./workbox-window-295a6886.js"),[],import.meta.url);f=new y("./sw.js",{scope:"./",type:"classic"}),g=async()=>{await(f==null?void 0:f.messageSkipWaiting())};{let p=!1;const m=()=>{p=!0,f==null||f.addEventListener("controlling",v=>{v.isUpdate&&window.location.reload()}),n==null||n()};f.addEventListener("installed",v=>{typeof v.isUpdate>"u"?typeof v.isExternal<"u"?v.isExternal?m():!p&&(o==null||o()):v.isExternal?window.location.reload():!p&&(o==null||o()):v.isUpdate||o==null||o()}),f.addEventListener("waiting",m),f.addEventListener("externalwaiting",m)}f.register({immediate:t}).then(p=>{s?s("./sw.js",p):r==null||r(p)}).catch(p=>{i==null||i(p)})}}return h=L(),w}function ut(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:o,onRegistered:r,onRegisteredSW:s,onRegisterError:i}=e,f=E(!1),h=E(!1);return{updateServiceWorker:ct({immediate:t,onNeedRefresh(){f.value=!0,n==null||n()},onOfflineReady(){h.value=!0,o==null||o()},onRegistered:r,onRegisteredSW:s,onRegisterError:i}),offlineReady:h,needRefresh:f}}window.addEventListener("appinstalled",()=>console.log("appinstalled"));ut({onNeedRefresh:()=>confirm("新的内容可用，单击确定按钮进行更新")&&location.reload()});Y.setDefaultProps({borderWidth:2,borderColor:"#0000002f"});Q(lt).use(Y).mount("#app");
